
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>时间粒度 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="dimensionspecs.html" />
    
    
    <link rel="prev" href="filters.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    开始
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../design/">
            
                <a href="../design/">
            
                    
                    Apache Druid简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../tutorials/">
            
                <a href="../tutorials/">
            
                    
                    快速入门
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../tutorials/docker.html">
            
                <a href="../tutorials/docker.html">
            
                    
                    通过Docker启动
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../operations/single-server.html">
            
                <a href="../operations/single-server.html">
            
                    
                    单机部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../tutorials/cluster.html">
            
                <a href="../tutorials/cluster.html">
            
                    
                    集群部署
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    指南
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../tutorials/tutorial-batch.html">
            
                <a href="../tutorials/tutorial-batch.html">
            
                    
                    从本地文件摄入数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../tutorials/tutorial-kafka.html">
            
                <a href="../tutorials/tutorial-kafka.html">
            
                    
                    从Kafka摄入数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../tutorials/tutorial-batch-hadoop.html">
            
                <a href="../tutorials/tutorial-batch-hadoop.html">
            
                    
                    从Haddop摄入数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../tutorials/tutorial-query.html">
            
                <a href="../tutorials/tutorial-query.html">
            
                    
                    查询数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../tutorials/tutorial-rollup.html">
            
                <a href="../tutorials/tutorial-rollup.html">
            
                    
                    预聚合
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../tutorials/tutorial-retention.html">
            
                <a href="../tutorials/tutorial-retention.html">
            
                    
                    数据留存规则
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../tutorials/tutorial-update-data.html">
            
                <a href="../tutorials/tutorial-update-data.html">
            
                    
                    更新数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../tutorials/tutorial-compaction.html">
            
                <a href="../tutorials/tutorial-compaction.html">
            
                    
                    数据文件合并
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../tutorials/tutorial-delete-data.html">
            
                <a href="../tutorials/tutorial-delete-data.html">
            
                    
                    删除数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../tutorials/tutorial-ingestion-spec.html">
            
                <a href="../tutorials/tutorial-ingestion-spec.html">
            
                    
                    编写数据摄入规则
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.11" data-path="../tutorials/tutorial-transform-spec.html">
            
                <a href="../tutorials/tutorial-transform-spec.html">
            
                    
                    转换摄入数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.12" data-path="../tutorials/tutorial-kerberos-hadoop.html">
            
                <a href="../tutorials/tutorial-kerberos-hadoop.html">
            
                    
                    设置Kerberos认证的HDFS作为深度存储
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    设计
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../design/architecture.html">
            
                <a href="../design/architecture.html">
            
                    
                    整体架构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../design/segments.html">
            
                <a href="../design/segments.html">
            
                    
                    存储结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../design/processes.html">
            
                <a href="../design/processes.html">
            
                    
                    进程与服务
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../dependencies/deep-storage.html">
            
                <a href="../dependencies/deep-storage.html">
            
                    
                    深度存储
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../dependencies/metadata-storage.html">
            
                <a href="../dependencies/metadata-storage.html">
            
                    
                    元数据存储
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../dependencies/zookeeper.html">
            
                <a href="../dependencies/zookeeper.html">
            
                    
                    Zookeeper
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    数据摄入
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../ingestion/">
            
                <a href="../ingestion/">
            
                    
                    概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../ingestion/data-formats.html">
            
                <a href="../ingestion/data-formats.html">
            
                    
                    数据格式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../ingestion/schema-design.html">
            
                <a href="../ingestion/schema-design.html">
            
                    
                    Schema定义
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../ingestion/data-management.html">
            
                <a href="../ingestion/data-management.html">
            
                    
                    数据管理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" >
            
                <span>
            
                    
                    实时摄入
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.5.1" data-path="../development/extensions-core/kafka-ingestion.html">
            
                <a href="../development/extensions-core/kafka-ingestion.html">
            
                    
                    从Kafka摄入
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.2" data-path="../development/extensions-core/kinesis-ingestion.html">
            
                <a href="../development/extensions-core/kinesis-ingestion.html">
            
                    
                    从Amazon Kinesis摄入
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.3" data-path="../ingestion/tranquility.html">
            
                <a href="../ingestion/tranquility.html">
            
                    
                    从Tranqulity摄入
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.4" data-path="../ingestion/standalone-realtime.html">
            
                <a href="../ingestion/standalone-realtime.html">
            
                    
                    独立实时模式
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.6" >
            
                <span>
            
                    
                    批量导入
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.6.1" data-path="../ingestion/native-batch.html">
            
                <a href="../ingestion/native-batch.html">
            
                    
                    本地模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.2" data-path="../ingestion/hadoop.html">
            
                <a href="../ingestion/hadoop.html">
            
                    
                    从Hadoop导入
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="../ingestion/tasks.html">
            
                <a href="../ingestion/tasks.html">
            
                    
                    Druid中的任务
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="../ingestion/faq.html">
            
                <a href="../ingestion/faq.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    数据查询
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="sql.html">
            
                <a href="sql.html">
            
                    
                    通过SQL查询
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="querying.html">
            
                <a href="querying.html">
            
                    
                    通过JSON查询
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="query-execution.html">
            
                <a href="query-execution.html">
            
                    
                    查询执行流程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" >
            
                <span>
            
                    
                    主要概念
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.4.1" data-path="datasource.html">
            
                <a href="datasource.html">
            
                    
                    数据源(datasource)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.2" data-path="joins.html">
            
                <a href="joins.html">
            
                    
                    联合查询(join)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.3" data-path="lookups.html">
            
                <a href="lookups.html">
            
                    
                    字典查询(lookups)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.4" data-path="multi-value-dimensions.html">
            
                <a href="multi-value-dimensions.html">
            
                    
                    结构化列值(multi-value-dimensions)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.5" data-path="multitenancy.html">
            
                <a href="multitenancy.html">
            
                    
                    多租户
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.6" data-path="caching.html">
            
                <a href="caching.html">
            
                    
                    查询缓存
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.7" data-path="query-context.html">
            
                <a href="query-context.html">
            
                    
                    查询上下文
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.5" >
            
                <span>
            
                    
                    JSON查询类型
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.5.1" data-path="timeseriesquery.html">
            
                <a href="timeseriesquery.html">
            
                    
                    Timeseries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.2" data-path="topnquery.html">
            
                <a href="topnquery.html">
            
                    
                    TopN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.3" data-path="groupbyquery.html">
            
                <a href="groupbyquery.html">
            
                    
                    GroupBy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.4" data-path="scan-query.html">
            
                <a href="scan-query.html">
            
                    
                    Scan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.5" data-path="searchquery.html">
            
                <a href="searchquery.html">
            
                    
                    Search
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.6" data-path="timeboundaryquery.html">
            
                <a href="timeboundaryquery.html">
            
                    
                    TimeBoundary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.7" data-path="segmentmetadataquery.html">
            
                <a href="segmentmetadataquery.html">
            
                    
                    SegmentMetaData
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.8" data-path="datasourcemetadataquery.html">
            
                <a href="datasourcemetadataquery.html">
            
                    
                    DatasourceMetadata
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.6" >
            
                <span>
            
                    
                    JSON查询结构
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.6.1" data-path="filters.html">
            
                <a href="filters.html">
            
                    
                    过滤器
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.6.6.2" data-path="granularities.html">
            
                <a href="granularities.html">
            
                    
                    时间粒度
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.3" data-path="dimensionspecs.html">
            
                <a href="dimensionspecs.html">
            
                    
                    数据维度
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.4" data-path="aggregations.html">
            
                <a href="aggregations.html">
            
                    
                    聚合
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.5" data-path="post-aggregations.html">
            
                <a href="post-aggregations.html">
            
                    
                    后置聚合
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.6" data-path="../misc/math-expr.html">
            
                <a href="../misc/math-expr.html">
            
                    
                    数学函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.7" data-path="having.html">
            
                <a href="having.html">
            
                    
                    表达式与函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.8" data-path="limitspec.html">
            
                <a href="limitspec.html">
            
                    
                    Having过滤器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.9" data-path="topnmetricspec.html">
            
                <a href="topnmetricspec.html">
            
                    
                    TopN排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.10" data-path="sorting-orders.html">
            
                <a href="sorting-orders.html">
            
                    
                    排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.11" data-path="virtual-columns.html">
            
                <a href="virtual-columns.html">
            
                    
                    虚拟字段
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.12" data-path="../development/geo.html">
            
                <a href="../development/geo.html">
            
                    
                    空间过滤
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    配置
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../configuration/">
            
                <a href="../configuration/">
            
                    
                    概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../development/extensions.html">
            
                <a href="../development/extensions.html">
            
                    
                    扩展组件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../configuration/logging.html">
            
                <a href="../configuration/logging.html">
            
                    
                    运行日志
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    运维
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../operations/druid-console.html">
            
                <a href="../operations/druid-console.html">
            
                    
                    Web控制台
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../operations/getting-started.html">
            
                <a href="../operations/getting-started.html">
            
                    
                    快速开始
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.1" >
            
                <span>
            
                    
                    安全
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.1.1" data-path="../operations/security-overview.html">
            
                <a href="../operations/security-overview.html">
            
                    
                    概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.1.2" data-path="../operations/security-user-auth.html">
            
                <a href="../operations/security-user-auth.html">
            
                    
                    用户认证
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.1.3" data-path="../operations/auth-ldap.html">
            
                <a href="../operations/auth-ldap.html">
            
                    
                    LDAP认证
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.1.4" data-path="../operations/password-provider.html">
            
                <a href="../operations/password-provider.html">
            
                    
                    密码管理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.1.5" data-path="../design/auth.html">
            
                <a href="../design/auth.html">
            
                    
                    认证
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.1.6" data-path="../operations/tls-support.html">
            
                <a href="../operations/tls-support.html">
            
                    
                    TLS加密支持
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.2.2" >
            
                <span>
            
                    
                    性能
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.2.1" data-path="../operations/basic-cluster-tuning.html">
            
                <a href="../operations/basic-cluster-tuning.html">
            
                    
                    集群调优
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2.2" data-path="../operations/segment-optimization.html">
            
                <a href="../operations/segment-optimization.html">
            
                    
                    数据段文件优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2.3" data-path="../operations/http-compression.html">
            
                <a href="../operations/http-compression.html">
            
                    
                    HTTP压缩
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.2.3" data-path="../operations/api-reference.html">
            
                <a href="../operations/api-reference.html">
            
                    
                    API手册
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.4" data-path="../operations/high-availability.html">
            
                <a href="../operations/high-availability.html">
            
                    
                    高可用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.5" data-path="../operations/rolling-updates.html">
            
                <a href="../operations/rolling-updates.html">
            
                    
                    版本滚动升级
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.6" data-path="../operations/rule-configuration.html">
            
                <a href="../operations/rule-configuration.html">
            
                    
                    数据留存规则
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.7" data-path="../operations/metrics.html">
            
                <a href="../operations/metrics.html">
            
                    
                    应用指标
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.8" data-path="../operations/alerts.html">
            
                <a href="../operations/alerts.html">
            
                    
                    告警
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.9" data-path="../operations/other-hadoop.html">
            
                <a href="../operations/other-hadoop.html">
            
                    
                    Hadoop相关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10" >
            
                <span>
            
                    
                    其他
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.10.1" data-path="../operations/management-uis.html">
            
                <a href="../operations/management-uis.html">
            
                    
                    管理界面
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.2" data-path="../operations/dump-segment.html">
            
                <a href="../operations/dump-segment.html">
            
                    
                    导出数据段文件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.3" data-path="../operations/reset-cluster.html">
            
                <a href="../operations/reset-cluster.html">
            
                    
                    重置集群
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.4" data-path="../operations/insert-segment-to-db.html">
            
                <a href="../operations/insert-segment-to-db.html">
            
                    
                    插入数据段文件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.5" data-path="../operations/pull-deps.html">
            
                <a href="../operations/pull-deps.html">
            
                    
                    pull-deps工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.6" data-path="../operations/deep-storage-migration.html">
            
                <a href="../operations/deep-storage-migration.html">
            
                    
                    迁移深度存储
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.7" data-path="../operations/export-metadata.html">
            
                <a href="../operations/export-metadata.html">
            
                    
                    导出元数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.8" data-path="../operations/metadata-migration.html">
            
                <a href="../operations/metadata-migration.html">
            
                    
                    元数据迁移
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.9" data-path="../operations/use_sbt_to_build_fat_jar.html">
            
                <a href="../operations/use_sbt_to_build_fat_jar.html">
            
                    
                    打包fat jar
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    Druid开发
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../development/overview.html">
            
                <a href="../development/overview.html">
            
                    
                    概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../development/modules.html">
            
                <a href="../development/modules.html">
            
                    
                    模块
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../development/javascript.html">
            
                <a href="../development/javascript.html">
            
                    
                    javascript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../development/build.html">
            
                <a href="../development/build.html">
            
                    
                    构建
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="../development/versioning.html">
            
                <a href="../development/versioning.html">
            
                    
                    版本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="../development/experimental.html">
            
                <a href="../development/experimental.html">
            
                    
                    实验功能
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" >
            
                <span>
            
                    
                    其他
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../misc/papers-and-talks.html">
            
                <a href="../misc/papers-and-talks.html">
            
                    
                    论文与演讲
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >时间粒度</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><ul><ul><li><span class="title-icon "></span><a href="#simple-granularities"><b>1.1.1. </b>Simple Granularities</a></li><li><span class="title-icon "></span><a href="#duration-granularities"><b>1.1.2. </b>Duration Granularities</a></li><li><span class="title-icon "></span><a href="#period-granularities"><b>1.1.3. </b>Period Granularities</a></li></ul></ul></ul></div><a href="#" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~   http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied.  See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
  -->
<blockquote>
<p>Apache Druid supports two query languages: <a href="sql.html">Druid SQL</a> and <a href="querying.html">native queries</a>.
This document describes the native
language. For information about time functions available in SQL, refer to the
<a href="sql.html#time-functions">SQL documentation</a>.</p>
</blockquote>
<p>The granularity field determines how data gets bucketed across the time dimension, or how it gets aggregated by hour, day, minute, etc.</p>
<p>It can be specified either as a string for simple granularities or as an object for arbitrary granularities.</p>
<h3 id="simple-granularities"><a name="simple-granularities" class="anchor-navigation-ex-anchor" href="#simple-granularities"><i class="fa fa-link" aria-hidden="true"></i></a>1.1.1. Simple Granularities</h3>
<p>Simple granularities are specified as a string and bucket timestamps by their UTC time (e.g., days start at 00:00 UTC).</p>
<p>Supported granularity strings are: <code>all</code>, <code>none</code>, <code>second</code>, <code>minute</code>, <code>fifteen_minute</code>, <code>thirty_minute</code>, <code>hour</code>, <code>day</code>, <code>week</code>, <code>month</code>, <code>quarter</code> and <code>year</code>.</p>
<ul>
<li><code>all</code> buckets everything into a single bucket</li>
<li><code>none</code> does not bucket data (it actually uses the granularity of the index - minimum here is <code>none</code> which means millisecond granularity). Using <code>none</code> in a <a href="timeseriesquery.html">TimeseriesQuery</a> is currently not recommended (the system will try to generate 0 values for all milliseconds that didn&#x2019;t exist, which is often a lot).</li>
</ul>
<h4 id="example"><a name="example" class="anchor-navigation-ex-anchor" href="#example"><i class="fa fa-link" aria-hidden="true"></i></a>Example:</h4>
<p>Suppose you have data below stored in Apache Druid with millisecond ingestion granularity,</p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-string">&quot;2013-08-31T01:02:33Z&quot;</span>, <span class="hljs-string">&quot;page&quot;</span>: <span class="hljs-string">&quot;AAA&quot;</span>, <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>}
{<span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-string">&quot;2013-09-01T01:02:33Z&quot;</span>, <span class="hljs-string">&quot;page&quot;</span>: <span class="hljs-string">&quot;BBB&quot;</span>, <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>}
{<span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-string">&quot;2013-09-02T23:32:45Z&quot;</span>, <span class="hljs-string">&quot;page&quot;</span>: <span class="hljs-string">&quot;CCC&quot;</span>, <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>}
{<span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-string">&quot;2013-09-03T03:32:45Z&quot;</span>, <span class="hljs-string">&quot;page&quot;</span>: <span class="hljs-string">&quot;DDD&quot;</span>, <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>}
</code></pre>
<p>After submitting a groupBy query with <code>hour</code> granularity,</p>
<pre><code class="lang-json">{
   <span class="hljs-string">&quot;queryType&quot;</span>:<span class="hljs-string">&quot;groupBy&quot;</span>,
   <span class="hljs-string">&quot;dataSource&quot;</span>:<span class="hljs-string">&quot;my_dataSource&quot;</span>,
   <span class="hljs-string">&quot;granularity&quot;</span>:<span class="hljs-string">&quot;hour&quot;</span>,
   <span class="hljs-string">&quot;dimensions&quot;</span>:[
      <span class="hljs-string">&quot;language&quot;</span>
   ],
   <span class="hljs-string">&quot;aggregations&quot;</span>:[
      {
         <span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;count&quot;</span>,
         <span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;count&quot;</span>
      }
   ],
   <span class="hljs-string">&quot;intervals&quot;</span>:[
      <span class="hljs-string">&quot;2000-01-01T00:00Z/3000-01-01T00:00Z&quot;</span>
   ]
}
</code></pre>
<p>you will get</p>
<pre><code class="lang-json">[ {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-08-31T01:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-01T01:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-02T23:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-03T03:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
} ]
</code></pre>
<p>Note that all the empty buckets are discarded.</p>
<p>If you change the granularity to <code>day</code>, you will get</p>
<pre><code class="lang-json">[ {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-08-31T00:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-01T00:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-02T00:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-03T00:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
} ]
</code></pre>
<p>If you change the granularity to <code>none</code>, you will get the same results as setting it to the ingestion granularity.</p>
<pre><code class="lang-json">[ {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-08-31T01:02:33.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-01T01:02:33.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-02T23:32:45.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-03T03:32:45.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
} ]
</code></pre>
<p>Having a query time <code>granularity</code> that is smaller than the <code>queryGranularity</code> parameter set at
<a href="../ingestion/#granularityspec">ingestion time</a> is unreasonable because information about that
smaller granularity is not present in the indexed data. So, if the query time granularity is smaller than the ingestion
time query granularity, Druid produces results that are equivalent to having set <code>granularity</code> to <code>queryGranularity</code>.</p>
<p>If you change the granularity to <code>all</code>, you will get everything aggregated in 1 bucket,</p>
<pre><code class="lang-json">[ {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2000-01-01T00:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">4</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
} ]
</code></pre>
<h3 id="duration-granularities"><a name="duration-granularities" class="anchor-navigation-ex-anchor" href="#duration-granularities"><i class="fa fa-link" aria-hidden="true"></i></a>1.1.2. Duration Granularities</h3>
<p>Duration granularities are specified as an exact duration in milliseconds and timestamps are returned as UTC. Duration granularity values are in millis.</p>
<p>They also support specifying an optional origin, which defines where to start counting time buckets from (defaults to 1970-01-01T00:00:00Z).</p>
<pre><code class="lang-javascript">{<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;duration&quot;</span>, <span class="hljs-string">&quot;duration&quot;</span>: <span class="hljs-number">7200000</span>}
</code></pre>
<p>This chunks up every 2 hours.</p>
<pre><code class="lang-javascript">{<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;duration&quot;</span>, <span class="hljs-string">&quot;duration&quot;</span>: <span class="hljs-number">3600000</span>, <span class="hljs-string">&quot;origin&quot;</span>: <span class="hljs-string">&quot;2012-01-01T00:30:00Z&quot;</span>}
</code></pre>
<p>This chunks up every hour on the half-hour.</p>
<h4 id="example_1"><a name="example_1" class="anchor-navigation-ex-anchor" href="#example_1"><i class="fa fa-link" aria-hidden="true"></i></a>Example:</h4>
<p>Reusing the data in the previous example, after submitting a groupBy query with 24 hours duration,</p>
<pre><code class="lang-json">{
   <span class="hljs-string">&quot;queryType&quot;</span>:<span class="hljs-string">&quot;groupBy&quot;</span>,
   <span class="hljs-string">&quot;dataSource&quot;</span>:<span class="hljs-string">&quot;my_dataSource&quot;</span>,
   <span class="hljs-string">&quot;granularity&quot;</span>:{<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;duration&quot;</span>, <span class="hljs-string">&quot;duration&quot;</span>: <span class="hljs-string">&quot;86400000&quot;</span>},
   <span class="hljs-string">&quot;dimensions&quot;</span>:[
      <span class="hljs-string">&quot;language&quot;</span>
   ],
   <span class="hljs-string">&quot;aggregations&quot;</span>:[
      {
         <span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;count&quot;</span>,
         <span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;count&quot;</span>
      }
   ],
   <span class="hljs-string">&quot;intervals&quot;</span>:[
      <span class="hljs-string">&quot;2000-01-01T00:00Z/3000-01-01T00:00Z&quot;</span>
   ]
}
</code></pre>
<p>you will get</p>
<pre><code class="lang-json">[ {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-08-31T00:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-01T00:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-02T00:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-03T00:00:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
} ]
</code></pre>
<p>if you set the origin for the granularity to <code>2012-01-01T00:30:00Z</code>,</p>
<pre><code class="lang-javascript">   <span class="hljs-string">&quot;granularity&quot;</span>:{<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;duration&quot;</span>, <span class="hljs-string">&quot;duration&quot;</span>: <span class="hljs-string">&quot;86400000&quot;</span>, <span class="hljs-string">&quot;origin&quot;</span>:<span class="hljs-string">&quot;2012-01-01T00:30:00Z&quot;</span>}
</code></pre>
<p>you will get</p>
<pre><code class="lang-json">[ {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-08-31T00:30:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-01T00:30:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-02T00:30:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-03T00:30:00.000Z&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
} ]
</code></pre>
<p>Note that the timestamp for each bucket starts at the 30th minute.</p>
<h3 id="period-granularities"><a name="period-granularities" class="anchor-navigation-ex-anchor" href="#period-granularities"><i class="fa fa-link" aria-hidden="true"></i></a>1.1.3. Period Granularities</h3>
<p>Period granularities are specified as arbitrary period combinations of years, months, weeks, hours, minutes and seconds (e.g. P2W, P3M, PT1H30M, PT0.750S) in <a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank">ISO8601</a> format. They support specifying a time zone which determines where period boundaries start as well as the timezone of the returned timestamps. By default, years start on the first of January, months start on the first of the month and weeks start on Mondays unless an origin is specified.</p>
<p>Time zone is optional (defaults to UTC). Origin is optional (defaults to 1970-01-01T00:00:00 in the given time zone).</p>
<pre><code class="lang-javascript">{<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;period&quot;</span>, <span class="hljs-string">&quot;period&quot;</span>: <span class="hljs-string">&quot;P2D&quot;</span>, <span class="hljs-string">&quot;timeZone&quot;</span>: <span class="hljs-string">&quot;America/Los_Angeles&quot;</span>}
</code></pre>
<p>This will bucket by two-day chunks in the Pacific timezone.</p>
<pre><code class="lang-javascript">{<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;period&quot;</span>, <span class="hljs-string">&quot;period&quot;</span>: <span class="hljs-string">&quot;P3M&quot;</span>, <span class="hljs-string">&quot;timeZone&quot;</span>: <span class="hljs-string">&quot;America/Los_Angeles&quot;</span>, <span class="hljs-string">&quot;origin&quot;</span>: <span class="hljs-string">&quot;2012-02-01T00:00:00-08:00&quot;</span>}
</code></pre>
<p>This will bucket by 3-month chunks in the Pacific timezone where the three-month quarters are defined as starting from February.</p>
<h4 id="example_2"><a name="example_2" class="anchor-navigation-ex-anchor" href="#example_2"><i class="fa fa-link" aria-hidden="true"></i></a>Example</h4>
<p>Reusing the data in the previous example, if you submit a groupBy query with 1 day period in Pacific timezone,</p>
<pre><code class="lang-json">{
   <span class="hljs-string">&quot;queryType&quot;</span>:<span class="hljs-string">&quot;groupBy&quot;</span>,
   <span class="hljs-string">&quot;dataSource&quot;</span>:<span class="hljs-string">&quot;my_dataSource&quot;</span>,
   <span class="hljs-string">&quot;granularity&quot;</span>:{<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;period&quot;</span>, <span class="hljs-string">&quot;period&quot;</span>: <span class="hljs-string">&quot;P1D&quot;</span>, <span class="hljs-string">&quot;timeZone&quot;</span>: <span class="hljs-string">&quot;America/Los_Angeles&quot;</span>},
   <span class="hljs-string">&quot;dimensions&quot;</span>:[
      <span class="hljs-string">&quot;language&quot;</span>
   ],
   <span class="hljs-string">&quot;aggregations&quot;</span>:[
      {
         <span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;count&quot;</span>,
         <span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;count&quot;</span>
      }
   ],
   <span class="hljs-string">&quot;intervals&quot;</span>:[
      <span class="hljs-string">&quot;1999-12-31T16:00:00.000-08:00/2999-12-31T16:00:00.000-08:00&quot;</span>
   ]
}
</code></pre>
<p>you will get</p>
<pre><code class="lang-json">[ {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-08-30T00:00:00.000-07:00&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-08-31T00:00:00.000-07:00&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-02T00:00:00.000-07:00&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">2</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
} ]
</code></pre>
<p>Note that the timestamp for each bucket has been converted to Pacific time. Row <code>{&quot;timestamp&quot;: &quot;2013-09-02T23:32:45Z&quot;, &quot;page&quot;: &quot;CCC&quot;, &quot;language&quot; : &quot;en&quot;}</code> and
<code>{&quot;timestamp&quot;: &quot;2013-09-03T03:32:45Z&quot;, &quot;page&quot;: &quot;DDD&quot;, &quot;language&quot; : &quot;en&quot;}</code> are put in the same bucket because they are in the same day in Pacific time.</p>
<p>Also note that the <code>intervals</code> in groupBy query will not be converted to the timezone specified, the timezone specified in granularity is only applied on the
query results.</p>
<p>If you set the origin for the granularity to <code>1970-01-01T20:30:00-08:00</code>,</p>
<pre><code class="lang-javascript">   <span class="hljs-string">&quot;granularity&quot;</span>:{<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;period&quot;</span>, <span class="hljs-string">&quot;period&quot;</span>: <span class="hljs-string">&quot;P1D&quot;</span>, <span class="hljs-string">&quot;timeZone&quot;</span>: <span class="hljs-string">&quot;America/Los_Angeles&quot;</span>, <span class="hljs-string">&quot;origin&quot;</span>: <span class="hljs-string">&quot;1970-01-01T20:30:00-08:00&quot;</span>}
</code></pre>
<p>you will get</p>
<pre><code class="lang-json">[ {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-08-29T20:30:00.000-07:00&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-08-30T20:30:00.000-07:00&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-01T20:30:00.000-07:00&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
}, {
  <span class="hljs-string">&quot;version&quot;</span> : <span class="hljs-string">&quot;v1&quot;</span>,
  <span class="hljs-string">&quot;timestamp&quot;</span> : <span class="hljs-string">&quot;2013-09-02T20:30:00.000-07:00&quot;</span>,
  <span class="hljs-string">&quot;event&quot;</span> : {
    <span class="hljs-string">&quot;count&quot;</span> : <span class="hljs-number">1</span>,
    <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>
  }
} ]
</code></pre>
<p>Note that the <code>origin</code> you specified has nothing to do with the timezone, it only serves as a starting point for locating the very first granularity bucket.
In this case, Row <code>{&quot;timestamp&quot;: &quot;2013-09-02T23:32:45Z&quot;, &quot;page&quot;: &quot;CCC&quot;, &quot;language&quot; : &quot;en&quot;}</code> and <code>{&quot;timestamp&quot;: &quot;2013-09-03T03:32:45Z&quot;, &quot;page&quot;: &quot;DDD&quot;, &quot;language&quot; : &quot;en&quot;}</code>
are not in the same bucket.</p>
<h4 id="supported-time-zones"><a name="supported-time-zones" class="anchor-navigation-ex-anchor" href="#supported-time-zones"><i class="fa fa-link" aria-hidden="true"></i></a>Supported Time Zones</h4>
<p>Timezone support is provided by the <a href="http://www.joda.org" target="_blank">Joda Time library</a>, which uses the standard IANA time zones. See the <a href="http://joda-time.sourceforge.net/timezones.html" target="_blank">Joda Time supported timezones</a>.</p>
<footer class="page-footer"><span class="copyright">&#x672C;&#x6587;&#x6E90;&#x81EA;Apache Druid&#xFF0C;<a href="https://github.com/apache/druid/tree/master/docs/querying/granularities.md" target="_blank">&#x9605;&#x8BFB;&#x539F;&#x6587;</a> </span><span class="footer-modification">&#x66F4;&#x65B0;&#x4E8E;&#xFF1A;
2020-10-12 09:28:46
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="filters.html" class="navigation navigation-prev " aria-label="Previous page: 过滤器">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="dimensionspecs.html" class="navigation navigation-next " aria-label="Next page: 数据维度">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"id":"granularities","title":"时间粒度","sidebar_label":"Granularities","level":"1.6.6.2","depth":3,"next":{"title":"数据维度","level":"1.6.6.3","depth":3,"path":"querying/dimensionspecs.md","ref":"querying/dimensionspecs.md","articles":[]},"previous":{"title":"过滤器","level":"1.6.6.1","depth":3,"path":"querying/filters.md","ref":"querying/filters.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["-search","highlight","livereload","search-pro","code","tbfed-pagefooter","anchor-navigation-ex","auto-scroll-table","hide-element","github"],"pluginsConfig":{"tbfed-pagefooter":{"copyright":"本文源自Apache Druid，<a href=\"https://github.com/apache/druid/tree/master/docs/{{file.path}}\">阅读原文</a>","modify_label":"更新于：","modify_format":"YYYY-MM-DD HH:mm:ss"},"github":{"url":"https://github.com/apache/druid"},"livereload":{},"search-pro":{},"auto-scroll-table":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code":{"copyButtons":true},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"querying/granularities.md","mtime":"2020-10-12T01:28:46.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-05-05T14:27:01.470Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

