
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>数据格式 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="schema-design.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    开始
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../design/">
            
                <a href="../design/">
            
                    
                    Apache Druid简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../tutorials/">
            
                <a href="../tutorials/">
            
                    
                    快速入门
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../tutorials/docker.html">
            
                <a href="../tutorials/docker.html">
            
                    
                    Docker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../operations/single-server.html">
            
                <a href="../operations/single-server.html">
            
                    
                    单机部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../tutorials/cluster.html">
            
                <a href="../tutorials/cluster.html">
            
                    
                    集群模式部署
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    指南
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../tutorials/tutorial-batch.html">
            
                <a href="../tutorials/tutorial-batch.html">
            
                    
                    从本地文件摄入数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../tutorials/tutorial-kafka.html">
            
                <a href="../tutorials/tutorial-kafka.html">
            
                    
                    从Kafka摄入数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../tutorials/tutorial-batch-hadoop.html">
            
                <a href="../tutorials/tutorial-batch-hadoop.html">
            
                    
                    从Haddop摄入数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../tutorials/tutorial-query.html">
            
                <a href="../tutorials/tutorial-query.html">
            
                    
                    查询数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../tutorials/tutorial-rollup.html">
            
                <a href="../tutorials/tutorial-rollup.html">
            
                    
                    预聚合
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../tutorials/tutorial-retention.html">
            
                <a href="../tutorials/tutorial-retention.html">
            
                    
                    数据留存规则
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../tutorials/tutorial-update-data.html">
            
                <a href="../tutorials/tutorial-update-data.html">
            
                    
                    更新数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../tutorials/tutorial-compaction.html">
            
                <a href="../tutorials/tutorial-compaction.html">
            
                    
                    数据文件合并
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../tutorials/tutorial-delete-data.html">
            
                <a href="../tutorials/tutorial-delete-data.html">
            
                    
                    删除数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../tutorials/tutorial-ingestion-spec.html">
            
                <a href="../tutorials/tutorial-ingestion-spec.html">
            
                    
                    编写数据摄入规则
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.11" data-path="../tutorials/tutorial-transform-spec.html">
            
                <a href="../tutorials/tutorial-transform-spec.html">
            
                    
                    转换摄入数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.12" data-path="../tutorials/tutorial-kerberos-hadoop.html">
            
                <a href="../tutorials/tutorial-kerberos-hadoop.html">
            
                    
                    设置Kerberos认证的HDFS作为深度存储
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    设计
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../design/architecture.html">
            
                <a href="../design/architecture.html">
            
                    
                    整体架构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../design/segments.html">
            
                <a href="../design/segments.html">
            
                    
                    存储结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../design/processes">
            
                <span>
            
                    
                    进程与服务
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../dependencies/deep-storage.html">
            
                <a href="../dependencies/deep-storage.html">
            
                    
                    深度存储
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../dependencies/metadata-storage.html">
            
                <a href="../dependencies/metadata-storage.html">
            
                    
                    元数据存储
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../dependencies/zookeeper.html">
            
                <a href="../dependencies/zookeeper.html">
            
                    
                    Zookeeper
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    数据摄入
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="./">
            
                <a href="./">
            
                    
                    概览
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5.2" data-path="data-formats.html">
            
                <a href="data-formats.html">
            
                    
                    数据格式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="schema-design.html">
            
                <a href="schema-design.html">
            
                    
                    Schema定义
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="data-management.html">
            
                <a href="data-management.html">
            
                    
                    数据管理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" >
            
                <span>
            
                    
                    实时摄入
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.5.1" data-path="../development/extensions-core/kafka-ingestion.html">
            
                <a href="../development/extensions-core/kafka-ingestion.html">
            
                    
                    从Kafka摄入
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.2" data-path="../development/extensions-core/kinesis-ingestion.html">
            
                <a href="../development/extensions-core/kinesis-ingestion.html">
            
                    
                    从Amazon Kinesis摄入
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.3" data-path="tranquility.html">
            
                <a href="tranquility.html">
            
                    
                    从Tranqulity摄入
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.4" data-path="standalone-realtime.html">
            
                <a href="standalone-realtime.html">
            
                    
                    独立实时模式
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.6" >
            
                <span>
            
                    
                    批量导入
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.6.1" data-path="native-batch.html">
            
                <a href="native-batch.html">
            
                    
                    本地模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.2" data-path="hadoop.html">
            
                <a href="hadoop.html">
            
                    
                    从Hadoop导入
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="tasks.html">
            
                <a href="tasks.html">
            
                    
                    Druid中的任务
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="faq.html">
            
                <a href="faq.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    数据查询
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../querying/sql.html">
            
                <a href="../querying/sql.html">
            
                    
                    通过SQL查询
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../querying/querying.html">
            
                <a href="../querying/querying.html">
            
                    
                    通过JSON查询
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../querying/query-execution.html">
            
                <a href="../querying/query-execution.html">
            
                    
                    查询执行流程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" >
            
                <span>
            
                    
                    主要概念
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.4.1" data-path="../querying/datasource.html">
            
                <a href="../querying/datasource.html">
            
                    
                    数据源(datasource)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.2" data-path="../querying/joins.html">
            
                <a href="../querying/joins.html">
            
                    
                    联合查询(join)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.3" data-path="../querying/lookups.html">
            
                <a href="../querying/lookups.html">
            
                    
                    字典查询(lookups)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.4" data-path="../querying/multi-value-dimensions.html">
            
                <a href="../querying/multi-value-dimensions.html">
            
                    
                    结构化列值(multi-value-dimensions)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.5" data-path="../querying/multitenancy.html">
            
                <a href="../querying/multitenancy.html">
            
                    
                    多租户
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.6" data-path="../querying/caching.html">
            
                <a href="../querying/caching.html">
            
                    
                    查询缓存
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.7" data-path="../querying/query-context.html">
            
                <a href="../querying/query-context.html">
            
                    
                    查询上下文
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.5" >
            
                <span>
            
                    
                    JSON查询类型
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.5.1" data-path="../querying/timeseriesquery.html">
            
                <a href="../querying/timeseriesquery.html">
            
                    
                    Timeseries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.2" data-path="../querying/topnquery.html">
            
                <a href="../querying/topnquery.html">
            
                    
                    TopN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.3" data-path="../querying/groupbyquery.html">
            
                <a href="../querying/groupbyquery.html">
            
                    
                    GroupBy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.4" data-path="../querying/scan-query.html">
            
                <a href="../querying/scan-query.html">
            
                    
                    Scan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.5" data-path="../querying/searchquery.html">
            
                <a href="../querying/searchquery.html">
            
                    
                    Search
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.6" data-path="../querying/timeboundaryquery.html">
            
                <a href="../querying/timeboundaryquery.html">
            
                    
                    TimeBoundary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.7" data-path="../querying/segmentmetadataquery.html">
            
                <a href="../querying/segmentmetadataquery.html">
            
                    
                    SegmentMetaData
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.8" data-path="../querying/datasourcemetadataquery.html">
            
                <a href="../querying/datasourcemetadataquery.html">
            
                    
                    DatasourceMetadata
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.6" >
            
                <span>
            
                    
                    JSON查询结构
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.6.1" data-path="../querying/filters.html">
            
                <a href="../querying/filters.html">
            
                    
                    过滤器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.2" data-path="../querying/granularities.html">
            
                <a href="../querying/granularities.html">
            
                    
                    时间粒度
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.3" data-path="../querying/dimensionspecs.html">
            
                <a href="../querying/dimensionspecs.html">
            
                    
                    数据维度
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.4" data-path="../querying/aggregations.html">
            
                <a href="../querying/aggregations.html">
            
                    
                    聚合
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.5" data-path="../querying/post-aggregations.html">
            
                <a href="../querying/post-aggregations.html">
            
                    
                    后置聚合
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.6" data-path="../misc/math-expr.html">
            
                <a href="../misc/math-expr.html">
            
                    
                    数学函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.7" data-path="../querying/having.html">
            
                <a href="../querying/having.html">
            
                    
                    表达式与函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.8" data-path="../querying/limitspec.html">
            
                <a href="../querying/limitspec.html">
            
                    
                    Having过滤器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.9" data-path="../querying/topnmetricspec.html">
            
                <a href="../querying/topnmetricspec.html">
            
                    
                    TopN排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.10" data-path="../querying/sorting-orders.html">
            
                <a href="../querying/sorting-orders.html">
            
                    
                    排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.11" data-path="../querying/virtual-columns.html">
            
                <a href="../querying/virtual-columns.html">
            
                    
                    虚拟字段
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6.12" data-path="../development/geo.html">
            
                <a href="../development/geo.html">
            
                    
                    空间过滤
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    配置
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../configuration/">
            
                <a href="../configuration/">
            
                    
                    概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../development/extensions.html">
            
                <a href="../development/extensions.html">
            
                    
                    扩展组件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../configuration/logging.html">
            
                <a href="../configuration/logging.html">
            
                    
                    运行日志
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    运维
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../operations/druid-console.html">
            
                <a href="../operations/druid-console.html">
            
                    
                    Web控制台
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../operations/getting-started.html">
            
                <a href="../operations/getting-started.html">
            
                    
                    快速开始
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.1" >
            
                <span>
            
                    
                    安全
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.1.1" data-path="../operations/security-overview.html">
            
                <a href="../operations/security-overview.html">
            
                    
                    概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.1.2" data-path="../operations/security-user-auth.html">
            
                <a href="../operations/security-user-auth.html">
            
                    
                    用户认证
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.1.3" data-path="../operations/auth-ldap.html">
            
                <a href="../operations/auth-ldap.html">
            
                    
                    LDAP认证
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.1.4" data-path="../operations/password-provider.html">
            
                <a href="../operations/password-provider.html">
            
                    
                    密码管理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.1.5" data-path="../design/auth.html">
            
                <a href="../design/auth.html">
            
                    
                    认证
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.1.6" data-path="../operations/tls-support.html">
            
                <a href="../operations/tls-support.html">
            
                    
                    TLS加密支持
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.2.2" >
            
                <span>
            
                    
                    性能
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.2.1" data-path="../operations/basic-cluster-tuning.html">
            
                <a href="../operations/basic-cluster-tuning.html">
            
                    
                    集群调优
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2.2" data-path="../operations/segment-optimization.html">
            
                <a href="../operations/segment-optimization.html">
            
                    
                    数据段文件优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2.3" data-path="../operations/http-compression.html">
            
                <a href="../operations/http-compression.html">
            
                    
                    HTTP压缩
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.2.3" data-path="../operations/api-reference.html">
            
                <a href="../operations/api-reference.html">
            
                    
                    API手册
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.4" data-path="../operations/high-availability.html">
            
                <a href="../operations/high-availability.html">
            
                    
                    高可用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.5" data-path="../operations/rolling-updates.html">
            
                <a href="../operations/rolling-updates.html">
            
                    
                    滚动版本升级
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.6" data-path="../operations/rule-configuration.html">
            
                <a href="../operations/rule-configuration.html">
            
                    
                    数据留存规则
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.7" data-path="../operations/metrics.html">
            
                <a href="../operations/metrics.html">
            
                    
                    应用指标
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.8" data-path="../operations/alerts.html">
            
                <a href="../operations/alerts.html">
            
                    
                    告警
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.9" data-path="../operations/other-hadoop.html">
            
                <a href="../operations/other-hadoop.html">
            
                    
                    Hadoop相关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10" >
            
                <span>
            
                    
                    其他
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.10.1" data-path="../operations/management-uis.html">
            
                <a href="../operations/management-uis.html">
            
                    
                    管理界面
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.2" data-path="../operations/dump-segment.html">
            
                <a href="../operations/dump-segment.html">
            
                    
                    导出数据段文件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.3" data-path="../operations/reset-cluster.html">
            
                <a href="../operations/reset-cluster.html">
            
                    
                    重置集群
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.4" data-path="../operations/insert-segment-to-db.html">
            
                <a href="../operations/insert-segment-to-db.html">
            
                    
                    插入数据段文件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.5" data-path="../operations/pull-deps.html">
            
                <a href="../operations/pull-deps.html">
            
                    
                    pull-deps工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.6" data-path="../operations/deep-storage-migration.html">
            
                <a href="../operations/deep-storage-migration.html">
            
                    
                    迁移深度存储
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.7" data-path="../operations/export-metadata.html">
            
                <a href="../operations/export-metadata.html">
            
                    
                    导出元数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.8" data-path="../operations/metadata-migration.html">
            
                <a href="../operations/metadata-migration.html">
            
                    
                    元数据迁移
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.10.9" data-path="../operations/use_sbt_to_build_fat_jar.html">
            
                <a href="../operations/use_sbt_to_build_fat_jar.html">
            
                    
                    打包fat jar
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    Druid开发
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../development/overview.html">
            
                <a href="../development/overview.html">
            
                    
                    概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../development/modules.html">
            
                <a href="../development/modules.html">
            
                    
                    模块
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../development/javascript.html">
            
                <a href="../development/javascript.html">
            
                    
                    javascript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../development/build.html">
            
                <a href="../development/build.html">
            
                    
                    构建
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="../development/versioning.html">
            
                <a href="../development/versioning.html">
            
                    
                    版本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="../development/experimental.html">
            
                <a href="../development/experimental.html">
            
                    
                    实验功能
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" >
            
                <span>
            
                    
                    其他
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../misc/papers-and-talks.html">
            
                <a href="../misc/papers-and-talks.html">
            
                    
                    论文与演讲
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >数据格式</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><ul><li><span class="title-icon "></span><a href="#formatting-the-data"><b>1.1. </b>Formatting the Data</a></li><li><span class="title-icon "></span><a href="#custom-formats"><b>1.2. </b>Custom Formats</a></li><li><span class="title-icon "></span><a href="#input-format"><b>1.3. </b>Input Format</a></li><ul><li><span class="title-icon "></span><a href="#json"><b>1.3.1. </b>JSON</a></li><li><span class="title-icon "></span><a href="#csv"><b>1.3.2. </b>CSV</a></li><li><span class="title-icon "></span><a href="#tsv-delimited"><b>1.3.3. </b>TSV (Delimited)</a></li><li><span class="title-icon "></span><a href="#orc"><b>1.3.4. </b>ORC</a></li><li><span class="title-icon "></span><a href="#parquet"><b>1.3.5. </b>Parquet</a></li><li><span class="title-icon "></span><a href="#avro-ocf"><b>1.3.6. </b>Avro OCF</a></li><li><span class="title-icon "></span><a href="#flattenspec"><b>1.3.7. </b>FlattenSpec</a></li></ul><li><span class="title-icon "></span><a href="#parser"><b>1.4. </b>Parser</a></li><ul><li><span class="title-icon "></span><a href="#string-parser"><b>1.4.1. </b>String Parser</a></li><li><span class="title-icon "></span><a href="#avro-hadoop-parser"><b>1.4.2. </b>Avro Hadoop Parser</a></li><li><span class="title-icon "></span><a href="#orc-hadoop-parser"><b>1.4.3. </b>ORC Hadoop Parser</a></li><li><span class="title-icon "></span><a href="#parquet-hadoop-parser"><b>1.4.4. </b>Parquet Hadoop Parser</a></li><li><span class="title-icon "></span><a href="#parquet-avro-hadoop-parser"><b>1.4.5. </b>Parquet Avro Hadoop Parser</a></li><li><span class="title-icon "></span><a href="#avro-stream-parser"><b>1.4.6. </b>Avro Stream Parser</a></li><li><span class="title-icon "></span><a href="#protobuf-parser"><b>1.4.7. </b>Protobuf Parser</a></li></ul><li><span class="title-icon "></span><a href="#parsespec"><b>1.5. </b>ParseSpec</a></li><ul><li><span class="title-icon "></span><a href="#json-parsespec"><b>1.5.1. </b>JSON ParseSpec</a></li><li><span class="title-icon "></span><a href="#json-lowercase-parsespec"><b>1.5.2. </b>JSON Lowercase ParseSpec</a></li><li><span class="title-icon "></span><a href="#csv-parsespec"><b>1.5.3. </b>CSV ParseSpec</a></li><li><span class="title-icon "></span><a href="#tsv--delimited-parsespec"><b>1.5.4. </b>TSV / Delimited ParseSpec</a></li><li><span class="title-icon "></span><a href="#multi-value-dimensions"><b>1.5.5. </b>Multi-value dimensions</a></li><li><span class="title-icon "></span><a href="#regex-parsespec"><b>1.5.6. </b>Regex ParseSpec</a></li><li><span class="title-icon "></span><a href="#javascript-parsespec"><b>1.5.7. </b>JavaScript ParseSpec</a></li><li><span class="title-icon "></span><a href="#timeanddims-parsespec"><b>1.5.8. </b>TimeAndDims ParseSpec</a></li><li><span class="title-icon "></span><a href="#orc-parsespec"><b>1.5.9. </b>Orc ParseSpec</a></li><li><span class="title-icon "></span><a href="#parquet-parsespec"><b>1.5.10. </b>Parquet ParseSpec</a></li></ul></ul></ul></div><a href="#" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~   http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied.  See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
  -->
<p>Apache Druid can ingest denormalized data in JSON, CSV, or a delimited form such as TSV, or any custom format. While most examples in the documentation use data in JSON format, it is not difficult to configure Druid to ingest any other delimited data.
We welcome any contributions to new formats.</p>
<p>This page lists all default and core extension data formats supported by Druid.
For additional data formats supported with community extensions,
please see our <a href="../development/extensions.html#community-extensions">community extensions list</a>.</p>
<h2 id="formatting-the-data"><a name="formatting-the-data" class="anchor-navigation-ex-anchor" href="#formatting-the-data"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. Formatting the Data</h2>
<p>The following samples show data formats that are natively supported in Druid:</p>
<p><em>JSON</em></p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-string">&quot;2013-08-31T01:02:33Z&quot;</span>, <span class="hljs-string">&quot;page&quot;</span>: <span class="hljs-string">&quot;Gypsy Danger&quot;</span>, <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>, <span class="hljs-string">&quot;user&quot;</span> : <span class="hljs-string">&quot;nuclear&quot;</span>, <span class="hljs-string">&quot;unpatrolled&quot;</span> : <span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-string">&quot;newPage&quot;</span> : <span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-string">&quot;robot&quot;</span>: <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-string">&quot;anonymous&quot;</span>: <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-string">&quot;namespace&quot;</span>:<span class="hljs-string">&quot;article&quot;</span>, <span class="hljs-string">&quot;continent&quot;</span>:<span class="hljs-string">&quot;North America&quot;</span>, <span class="hljs-string">&quot;country&quot;</span>:<span class="hljs-string">&quot;United States&quot;</span>, <span class="hljs-string">&quot;region&quot;</span>:<span class="hljs-string">&quot;Bay Area&quot;</span>, <span class="hljs-string">&quot;city&quot;</span>:<span class="hljs-string">&quot;San Francisco&quot;</span>, <span class="hljs-string">&quot;added&quot;</span>: <span class="hljs-number">57</span>, <span class="hljs-string">&quot;deleted&quot;</span>: <span class="hljs-number">200</span>, <span class="hljs-string">&quot;delta&quot;</span>: <span class="hljs-number">-143</span>}
{<span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-string">&quot;2013-08-31T03:32:45Z&quot;</span>, <span class="hljs-string">&quot;page&quot;</span>: <span class="hljs-string">&quot;Striker Eureka&quot;</span>, <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;en&quot;</span>, <span class="hljs-string">&quot;user&quot;</span> : <span class="hljs-string">&quot;speed&quot;</span>, <span class="hljs-string">&quot;unpatrolled&quot;</span> : <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-string">&quot;newPage&quot;</span> : <span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-string">&quot;robot&quot;</span>: <span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-string">&quot;anonymous&quot;</span>: <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-string">&quot;namespace&quot;</span>:<span class="hljs-string">&quot;wikipedia&quot;</span>, <span class="hljs-string">&quot;continent&quot;</span>:<span class="hljs-string">&quot;Australia&quot;</span>, <span class="hljs-string">&quot;country&quot;</span>:<span class="hljs-string">&quot;Australia&quot;</span>, <span class="hljs-string">&quot;region&quot;</span>:<span class="hljs-string">&quot;Cantebury&quot;</span>, <span class="hljs-string">&quot;city&quot;</span>:<span class="hljs-string">&quot;Syndey&quot;</span>, <span class="hljs-string">&quot;added&quot;</span>: <span class="hljs-number">459</span>, <span class="hljs-string">&quot;deleted&quot;</span>: <span class="hljs-number">129</span>, <span class="hljs-string">&quot;delta&quot;</span>: <span class="hljs-number">330</span>}
{<span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-string">&quot;2013-08-31T07:11:21Z&quot;</span>, <span class="hljs-string">&quot;page&quot;</span>: <span class="hljs-string">&quot;Cherno Alpha&quot;</span>, <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;ru&quot;</span>, <span class="hljs-string">&quot;user&quot;</span> : <span class="hljs-string">&quot;masterYi&quot;</span>, <span class="hljs-string">&quot;unpatrolled&quot;</span> : <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-string">&quot;newPage&quot;</span> : <span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-string">&quot;robot&quot;</span>: <span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-string">&quot;anonymous&quot;</span>: <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-string">&quot;namespace&quot;</span>:<span class="hljs-string">&quot;article&quot;</span>, <span class="hljs-string">&quot;continent&quot;</span>:<span class="hljs-string">&quot;Asia&quot;</span>, <span class="hljs-string">&quot;country&quot;</span>:<span class="hljs-string">&quot;Russia&quot;</span>, <span class="hljs-string">&quot;region&quot;</span>:<span class="hljs-string">&quot;Oblast&quot;</span>, <span class="hljs-string">&quot;city&quot;</span>:<span class="hljs-string">&quot;Moscow&quot;</span>, <span class="hljs-string">&quot;added&quot;</span>: <span class="hljs-number">123</span>, <span class="hljs-string">&quot;deleted&quot;</span>: <span class="hljs-number">12</span>, <span class="hljs-string">&quot;delta&quot;</span>: <span class="hljs-number">111</span>}
{<span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-string">&quot;2013-08-31T11:58:39Z&quot;</span>, <span class="hljs-string">&quot;page&quot;</span>: <span class="hljs-string">&quot;Crimson Typhoon&quot;</span>, <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;zh&quot;</span>, <span class="hljs-string">&quot;user&quot;</span> : <span class="hljs-string">&quot;triplets&quot;</span>, <span class="hljs-string">&quot;unpatrolled&quot;</span> : <span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-string">&quot;newPage&quot;</span> : <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-string">&quot;robot&quot;</span>: <span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-string">&quot;anonymous&quot;</span>: <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-string">&quot;namespace&quot;</span>:<span class="hljs-string">&quot;wikipedia&quot;</span>, <span class="hljs-string">&quot;continent&quot;</span>:<span class="hljs-string">&quot;Asia&quot;</span>, <span class="hljs-string">&quot;country&quot;</span>:<span class="hljs-string">&quot;China&quot;</span>, <span class="hljs-string">&quot;region&quot;</span>:<span class="hljs-string">&quot;Shanxi&quot;</span>, <span class="hljs-string">&quot;city&quot;</span>:<span class="hljs-string">&quot;Taiyuan&quot;</span>, <span class="hljs-string">&quot;added&quot;</span>: <span class="hljs-number">905</span>, <span class="hljs-string">&quot;deleted&quot;</span>: <span class="hljs-number">5</span>, <span class="hljs-string">&quot;delta&quot;</span>: <span class="hljs-number">900</span>}
{<span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-string">&quot;2013-08-31T12:41:27Z&quot;</span>, <span class="hljs-string">&quot;page&quot;</span>: <span class="hljs-string">&quot;Coyote Tango&quot;</span>, <span class="hljs-string">&quot;language&quot;</span> : <span class="hljs-string">&quot;ja&quot;</span>, <span class="hljs-string">&quot;user&quot;</span> : <span class="hljs-string">&quot;cancer&quot;</span>, <span class="hljs-string">&quot;unpatrolled&quot;</span> : <span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-string">&quot;newPage&quot;</span> : <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-string">&quot;robot&quot;</span>: <span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-string">&quot;anonymous&quot;</span>: <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-string">&quot;namespace&quot;</span>:<span class="hljs-string">&quot;wikipedia&quot;</span>, <span class="hljs-string">&quot;continent&quot;</span>:<span class="hljs-string">&quot;Asia&quot;</span>, <span class="hljs-string">&quot;country&quot;</span>:<span class="hljs-string">&quot;Japan&quot;</span>, <span class="hljs-string">&quot;region&quot;</span>:<span class="hljs-string">&quot;Kanto&quot;</span>, <span class="hljs-string">&quot;city&quot;</span>:<span class="hljs-string">&quot;Tokyo&quot;</span>, <span class="hljs-string">&quot;added&quot;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&quot;deleted&quot;</span>: <span class="hljs-number">10</span>, <span class="hljs-string">&quot;delta&quot;</span>: <span class="hljs-number">-9</span>}
</code></pre>
<p><em>CSV</em></p>
<pre><code>2013-08-31T01:02:33Z,&quot;Gypsy Danger&quot;,&quot;en&quot;,&quot;nuclear&quot;,&quot;true&quot;,&quot;true&quot;,&quot;false&quot;,&quot;false&quot;,&quot;article&quot;,&quot;North America&quot;,&quot;United States&quot;,&quot;Bay Area&quot;,&quot;San Francisco&quot;,57,200,-143
2013-08-31T03:32:45Z,&quot;Striker Eureka&quot;,&quot;en&quot;,&quot;speed&quot;,&quot;false&quot;,&quot;true&quot;,&quot;true&quot;,&quot;false&quot;,&quot;wikipedia&quot;,&quot;Australia&quot;,&quot;Australia&quot;,&quot;Cantebury&quot;,&quot;Syndey&quot;,459,129,330
2013-08-31T07:11:21Z,&quot;Cherno Alpha&quot;,&quot;ru&quot;,&quot;masterYi&quot;,&quot;false&quot;,&quot;true&quot;,&quot;true&quot;,&quot;false&quot;,&quot;article&quot;,&quot;Asia&quot;,&quot;Russia&quot;,&quot;Oblast&quot;,&quot;Moscow&quot;,123,12,111
2013-08-31T11:58:39Z,&quot;Crimson Typhoon&quot;,&quot;zh&quot;,&quot;triplets&quot;,&quot;true&quot;,&quot;false&quot;,&quot;true&quot;,&quot;false&quot;,&quot;wikipedia&quot;,&quot;Asia&quot;,&quot;China&quot;,&quot;Shanxi&quot;,&quot;Taiyuan&quot;,905,5,900
2013-08-31T12:41:27Z,&quot;Coyote Tango&quot;,&quot;ja&quot;,&quot;cancer&quot;,&quot;true&quot;,&quot;false&quot;,&quot;true&quot;,&quot;false&quot;,&quot;wikipedia&quot;,&quot;Asia&quot;,&quot;Japan&quot;,&quot;Kanto&quot;,&quot;Tokyo&quot;,1,10,-9
</code></pre><p><em>TSV (Delimited)</em></p>
<pre><code>2013-08-31T01:02:33Z  &quot;Gypsy Danger&quot;  &quot;en&quot;  &quot;nuclear&quot; &quot;true&quot;  &quot;true&quot;  &quot;false&quot; &quot;false&quot; &quot;article&quot; &quot;North America&quot; &quot;United States&quot; &quot;Bay Area&quot;  &quot;San Francisco&quot; 57  200 -143
2013-08-31T03:32:45Z  &quot;Striker Eureka&quot;  &quot;en&quot;  &quot;speed&quot; &quot;false&quot; &quot;true&quot;  &quot;true&quot;  &quot;false&quot; &quot;wikipedia&quot; &quot;Australia&quot; &quot;Australia&quot; &quot;Cantebury&quot; &quot;Syndey&quot;  459 129 330
2013-08-31T07:11:21Z  &quot;Cherno Alpha&quot;  &quot;ru&quot;  &quot;masterYi&quot;  &quot;false&quot; &quot;true&quot;  &quot;true&quot;  &quot;false&quot; &quot;article&quot; &quot;Asia&quot;  &quot;Russia&quot;  &quot;Oblast&quot;  &quot;Moscow&quot;  123 12  111
2013-08-31T11:58:39Z  &quot;Crimson Typhoon&quot; &quot;zh&quot;  &quot;triplets&quot;  &quot;true&quot;  &quot;false&quot; &quot;true&quot;  &quot;false&quot; &quot;wikipedia&quot; &quot;Asia&quot;  &quot;China&quot; &quot;Shanxi&quot;  &quot;Taiyuan&quot; 905 5 900
2013-08-31T12:41:27Z  &quot;Coyote Tango&quot;  &quot;ja&quot;  &quot;cancer&quot;  &quot;true&quot;  &quot;false&quot; &quot;true&quot;  &quot;false&quot; &quot;wikipedia&quot; &quot;Asia&quot;  &quot;Japan&quot; &quot;Kanto&quot; &quot;Tokyo&quot; 1 10  -9
</code></pre><p>Note that the CSV and TSV data do not contain column heads. This becomes important when you specify the data for ingesting.</p>
<p>Besides text formats, Druid also supports binary formats such as <a href="#orc">Orc</a> and <a href="#parquet">Parquet</a> formats.</p>
<h2 id="custom-formats"><a name="custom-formats" class="anchor-navigation-ex-anchor" href="#custom-formats"><i class="fa fa-link" aria-hidden="true"></i></a>1.2. Custom Formats</h2>
<p>Druid supports custom data formats and can use the <code>Regex</code> parser or the <code>JavaScript</code> parsers to parse these formats. Please note that using any of these parsers for
parsing data will not be as efficient as writing a native Java parser or using an external stream processor. We welcome contributions of new Parsers.</p>
<h2 id="input-format"><a name="input-format" class="anchor-navigation-ex-anchor" href="#input-format"><i class="fa fa-link" aria-hidden="true"></i></a>1.3. Input Format</h2>
<blockquote>
<p>The Input Format is a new way to specify the data format of your input data which was introduced in 0.17.0.
Unfortunately, the Input Format doesn&apos;t support all data formats or ingestion methods supported by Druid yet.
Especially if you want to use the Hadoop ingestion, you still need to use the <a href="#parser">Parser</a>.
If your data is formatted in some format not listed in this section, please consider using the Parser instead.</p>
</blockquote>
<p>All forms of Druid ingestion require some form of schema object. The format of the data to be ingested is specified using the <code>inputFormat</code> entry in your <a href="./#ioconfig"><code>ioConfig</code></a>.</p>
<h3 id="json"><a name="json" class="anchor-navigation-ex-anchor" href="#json"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.1. JSON</h3>
<p>The <code>inputFormat</code> to load data of JSON format. An example is:</p>
<pre><code class="lang-json"><span class="hljs-string">&quot;ioConfig&quot;</span>: {
  <span class="hljs-string">&quot;inputFormat&quot;</span>: {
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;json&quot;</span>
  },
  ...
}
</code></pre>
<p>The JSON <code>inputFormat</code> has the following components:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>json</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>flattenSpec</td>
<td>JSON Object</td>
<td>Specifies flattening configuration for nested JSON data. See <a href="#flattenspec"><code>flattenSpec</code></a> for more info.</td>
<td>no</td>
</tr>
<tr>
<td>featureSpec</td>
<td>JSON Object</td>
<td><a href="https://github.com/FasterXML/jackson-core/wiki/JsonParser-Features" target="_blank">JSON parser features</a> supported by Jackson library. Those features will be applied when parsing the input JSON data.</td>
<td>no</td>
</tr>
</tbody>
</table>
<h3 id="csv"><a name="csv" class="anchor-navigation-ex-anchor" href="#csv"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.2. CSV</h3>
<p>The <code>inputFormat</code> to load data of the CSV format. An example is:</p>
<pre><code class="lang-json"><span class="hljs-string">&quot;ioConfig&quot;</span>: {
  <span class="hljs-string">&quot;inputFormat&quot;</span>: {
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;csv&quot;</span>,
    <span class="hljs-string">&quot;columns&quot;</span> : [<span class="hljs-string">&quot;timestamp&quot;</span>,<span class="hljs-string">&quot;page&quot;</span>,<span class="hljs-string">&quot;language&quot;</span>,<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-string">&quot;unpatrolled&quot;</span>,<span class="hljs-string">&quot;newPage&quot;</span>,<span class="hljs-string">&quot;robot&quot;</span>,<span class="hljs-string">&quot;anonymous&quot;</span>,<span class="hljs-string">&quot;namespace&quot;</span>,<span class="hljs-string">&quot;continent&quot;</span>,<span class="hljs-string">&quot;country&quot;</span>,<span class="hljs-string">&quot;region&quot;</span>,<span class="hljs-string">&quot;city&quot;</span>,<span class="hljs-string">&quot;added&quot;</span>,<span class="hljs-string">&quot;deleted&quot;</span>,<span class="hljs-string">&quot;delta&quot;</span>]
  },
  ...
}
</code></pre>
<p>The CSV <code>inputFormat</code> has the following components:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>csv</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>listDelimiter</td>
<td>String</td>
<td>A custom delimiter for multi-value dimensions.</td>
<td>no (default = ctrl+A)</td>
</tr>
<tr>
<td>columns</td>
<td>JSON array</td>
<td>Specifies the columns of the data. The columns should be in the same order with the columns of your data.</td>
<td>yes if <code>findColumnsFromHeader</code> is false or missing</td>
</tr>
<tr>
<td>findColumnsFromHeader</td>
<td>Boolean</td>
<td>If this is set, the task will find the column names from the header row. Note that <code>skipHeaderRows</code> will be applied before finding column names from the header. For example, if you set <code>skipHeaderRows</code> to 2 and <code>findColumnsFromHeader</code> to true, the task will skip the first two lines and then extract column information from the third line. <code>columns</code> will be ignored if this is set to true.</td>
<td>no (default = false if <code>columns</code> is set; otherwise null)</td>
</tr>
<tr>
<td>skipHeaderRows</td>
<td>Integer</td>
<td>If this is set, the task will skip the first <code>skipHeaderRows</code> rows.</td>
<td>no (default = 0)</td>
</tr>
</tbody>
</table>
<h3 id="tsv-delimited"><a name="tsv-delimited" class="anchor-navigation-ex-anchor" href="#tsv-delimited"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.3. TSV (Delimited)</h3>
<pre><code class="lang-json"><span class="hljs-string">&quot;ioConfig&quot;</span>: {
  <span class="hljs-string">&quot;inputFormat&quot;</span>: {
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;tsv&quot;</span>,
    <span class="hljs-string">&quot;columns&quot;</span> : [<span class="hljs-string">&quot;timestamp&quot;</span>,<span class="hljs-string">&quot;page&quot;</span>,<span class="hljs-string">&quot;language&quot;</span>,<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-string">&quot;unpatrolled&quot;</span>,<span class="hljs-string">&quot;newPage&quot;</span>,<span class="hljs-string">&quot;robot&quot;</span>,<span class="hljs-string">&quot;anonymous&quot;</span>,<span class="hljs-string">&quot;namespace&quot;</span>,<span class="hljs-string">&quot;continent&quot;</span>,<span class="hljs-string">&quot;country&quot;</span>,<span class="hljs-string">&quot;region&quot;</span>,<span class="hljs-string">&quot;city&quot;</span>,<span class="hljs-string">&quot;added&quot;</span>,<span class="hljs-string">&quot;deleted&quot;</span>,<span class="hljs-string">&quot;delta&quot;</span>],
    <span class="hljs-string">&quot;delimiter&quot;</span>:<span class="hljs-string">&quot;|&quot;</span>
  },
  ...
}
</code></pre>
<p>The <code>inputFormat</code> to load data of a delimited format. An example is:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>tsv</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>delimiter</td>
<td>String</td>
<td>A custom delimiter for data values.</td>
<td>no (default = <code>\t</code>)</td>
</tr>
<tr>
<td>listDelimiter</td>
<td>String</td>
<td>A custom delimiter for multi-value dimensions.</td>
<td>no (default = ctrl+A)</td>
</tr>
<tr>
<td>columns</td>
<td>JSON array</td>
<td>Specifies the columns of the data. The columns should be in the same order with the columns of your data.</td>
<td>yes if <code>findColumnsFromHeader</code> is false or missing</td>
</tr>
<tr>
<td>findColumnsFromHeader</td>
<td>Boolean</td>
<td>If this is set, the task will find the column names from the header row. Note that <code>skipHeaderRows</code> will be applied before finding column names from the header. For example, if you set <code>skipHeaderRows</code> to 2 and <code>findColumnsFromHeader</code> to true, the task will skip the first two lines and then extract column information from the third line. <code>columns</code> will be ignored if this is set to true.</td>
<td>no (default = false if <code>columns</code> is set; otherwise null)</td>
</tr>
<tr>
<td>skipHeaderRows</td>
<td>Integer</td>
<td>If this is set, the task will skip the first <code>skipHeaderRows</code> rows.</td>
<td>no (default = 0)</td>
</tr>
</tbody>
</table>
<p>Be sure to change the <code>delimiter</code> to the appropriate delimiter for your data. Like CSV, you must specify the columns and which subset of the columns you want indexed.</p>
<h3 id="orc"><a name="orc" class="anchor-navigation-ex-anchor" href="#orc"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.4. ORC</h3>
<blockquote>
<p>You need to include the <a href="../development/extensions-core/orc.md"><code>druid-orc-extensions</code></a> as an extension to use the ORC input format.</p>
<p>If you are considering upgrading from earlier than 0.15.0 to 0.15.0 or a higher version,
please read <a href="../development/extensions-core/orc.md#migration-from-contrib-extension">Migration from &apos;contrib&apos; extension</a> carefully.</p>
</blockquote>
<p>The <code>inputFormat</code> to load data of ORC format. An example is:</p>
<pre><code class="lang-json"><span class="hljs-string">&quot;ioConfig&quot;</span>: {
  <span class="hljs-string">&quot;inputFormat&quot;</span>: {
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;orc&quot;</span>,
    <span class="hljs-string">&quot;flattenSpec&quot;</span>: {
      <span class="hljs-string">&quot;useFieldDiscovery&quot;</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-string">&quot;fields&quot;</span>: [
        {
          <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;path&quot;</span>,
          <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;nested&quot;</span>,
          <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;$.path.to.nested&quot;</span>
        }
      ]
    },
    <span class="hljs-string">&quot;binaryAsString&quot;</span>: <span class="hljs-literal">false</span>
  },
  ...
}
</code></pre>
<p>The ORC <code>inputFormat</code> has the following components:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>orc</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>flattenSpec</td>
<td>JSON Object</td>
<td>Specifies flattening configuration for nested ORC data. See <a href="#flattenspec"><code>flattenSpec</code></a> for more info.</td>
<td>no</td>
</tr>
<tr>
<td>binaryAsString</td>
<td>Boolean</td>
<td>Specifies if the binary orc column which is not logically marked as a string should be treated as a UTF-8 encoded string.</td>
<td>no (default = false)</td>
</tr>
</tbody>
</table>
<h3 id="parquet"><a name="parquet" class="anchor-navigation-ex-anchor" href="#parquet"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.5. Parquet</h3>
<blockquote>
<p>You need to include the <a href="../development/extensions-core/parquet.md"><code>druid-parquet-extensions</code></a> as an extension to use the Parquet input format.</p>
</blockquote>
<p>The <code>inputFormat</code> to load data of Parquet format. An example is:</p>
<pre><code class="lang-json"><span class="hljs-string">&quot;ioConfig&quot;</span>: {
  <span class="hljs-string">&quot;inputFormat&quot;</span>: {
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;parquet&quot;</span>,
    <span class="hljs-string">&quot;flattenSpec&quot;</span>: {
      <span class="hljs-string">&quot;useFieldDiscovery&quot;</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-string">&quot;fields&quot;</span>: [
        {
          <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;path&quot;</span>,
          <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;nested&quot;</span>,
          <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;$.path.to.nested&quot;</span>
        }
      ]
    },
    <span class="hljs-string">&quot;binaryAsString&quot;</span>: <span class="hljs-literal">false</span>
  },
  ...
}
</code></pre>
<p>The Parquet <code>inputFormat</code> has the following components:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should be set to <code>parquet</code> to read Parquet file</td>
<td>yes</td>
</tr>
<tr>
<td>flattenSpec</td>
<td>JSON Object</td>
<td>Define a <a href="#flattenspec"><code>flattenSpec</code></a> to extract nested values from a Parquet file. Note that only &apos;path&apos; expression are supported (&apos;jq&apos; is unavailable).</td>
<td>no (default will auto-discover &apos;root&apos; level properties)</td>
</tr>
<tr>
<td>binaryAsString</td>
<td>Boolean</td>
<td>Specifies if the bytes parquet column which is not logically marked as a string or enum type should be treated as a UTF-8 encoded string.</td>
<td>no (default = false)</td>
</tr>
</tbody>
</table>
<h3 id="avro-ocf"><a name="avro-ocf" class="anchor-navigation-ex-anchor" href="#avro-ocf"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.6. Avro OCF</h3>
<blockquote>
<p>You need to include the <a href="../development/extensions-core/avro.md"><code>druid-avro-extensions</code></a> as an extension to use the Avro OCF input format.</p>
<p>See the <a href="../development/extensions-core/avro.md#avro-types">Avro Types</a> section for how Avro types are handled in Druid</p>
</blockquote>
<p>The <code>inputFormat</code> to load data of Avro OCF format. An example is:</p>
<pre><code class="lang-json"><span class="hljs-string">&quot;ioConfig&quot;</span>: {
  <span class="hljs-string">&quot;inputFormat&quot;</span>: {
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;avro_ocf&quot;</span>,
    <span class="hljs-string">&quot;flattenSpec&quot;</span>: {
      <span class="hljs-string">&quot;useFieldDiscovery&quot;</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-string">&quot;fields&quot;</span>: [
        {
          <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;path&quot;</span>,
          <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;someRecord_subInt&quot;</span>,
          <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;$.someRecord.subInt&quot;</span>
        }
      ]
    },
    <span class="hljs-string">&quot;schema&quot;</span>: {
      <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;org.apache.druid.data.input&quot;</span>,
      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;SomeDatum&quot;</span>,
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;record&quot;</span>,
      <span class="hljs-string">&quot;fields&quot;</span> : [
        { <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;timestamp&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;long&quot;</span> },
        { <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;eventType&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;string&quot;</span> },
        { <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;long&quot;</span> },
        { <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;someRecord&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>: {
          <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;record&quot;</span>, <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;MySubRecord&quot;</span>, <span class="hljs-string">&quot;fields&quot;</span>: [
            { <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;subInt&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;int&quot;</span>},
            { <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;subLong&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;long&quot;</span>}
          ]
        }}]
    },
    <span class="hljs-string">&quot;binaryAsString&quot;</span>: <span class="hljs-literal">false</span>
  },
  ...
}
</code></pre>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should be set to <code>avro_ocf</code> to read Avro OCF file</td>
<td>yes</td>
</tr>
<tr>
<td>flattenSpec</td>
<td>JSON Object</td>
<td>Define a <a href="#flattenspec"><code>flattenSpec</code></a> to extract nested values from a Avro records. Note that only &apos;path&apos; expression are supported (&apos;jq&apos; is unavailable).</td>
<td>no (default will auto-discover &apos;root&apos; level properties)</td>
</tr>
<tr>
<td>schema</td>
<td>JSON Object</td>
<td>Define a reader schema to be used when parsing Avro records, this is useful when parsing multiple versions of Avro OCF file data</td>
<td>no (default will decode using the writer schema contained in the OCF file)</td>
</tr>
<tr>
<td>binaryAsString</td>
<td>Boolean</td>
<td>Specifies if the bytes parquet column which is not logically marked as a string or enum type should be treated as a UTF-8 encoded string.</td>
<td>no (default = false)</td>
</tr>
</tbody>
</table>
<h3 id="flattenspec"><a name="flattenspec" class="anchor-navigation-ex-anchor" href="#flattenspec"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.7. FlattenSpec</h3>
<p>The <code>flattenSpec</code> is located in <code>inputFormat</code> &#x2192; <code>flattenSpec</code> and is responsible for
bridging the gap between potentially nested input data (such as JSON, Avro, etc) and Druid&apos;s flat data model.
An example <code>flattenSpec</code> is:</p>
<pre><code class="lang-json"><span class="hljs-string">&quot;flattenSpec&quot;</span>: {
  <span class="hljs-string">&quot;useFieldDiscovery&quot;</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-string">&quot;fields&quot;</span>: [
    { <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;baz&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;root&quot;</span> },
    { <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;foo_bar&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;path&quot;</span>, <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;$.foo.bar&quot;</span> },
    { <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;first_food&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;jq&quot;</span>, <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;.thing.food[1]&quot;</span> }
  ]
}
</code></pre>
<blockquote>
<p>Conceptually, after input data records are read, the <code>flattenSpec</code> is applied first before
any other specs such as <a href="./#timestampspec"><code>timestampSpec</code></a>, <a href="./#transformspec"><code>transformSpec</code></a>,
<a href="./#dimensionsspec"><code>dimensionsSpec</code></a>, or <a href="./#metricsspec"><code>metricsSpec</code></a>. Keep this in mind when writing
your ingestion spec.</p>
</blockquote>
<p>Flattening is only supported for <a href="data-formats.html">data formats</a> that support nesting, including <code>avro</code>, <code>json</code>, <code>orc</code>,
and <code>parquet</code>.</p>
<p>A <code>flattenSpec</code> can have the following components:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>useFieldDiscovery</td>
<td>If true, interpret all root-level fields as available fields for usage by <a href="./#timestampspec"><code>timestampSpec</code></a>, <a href="./#transformspec"><code>transformSpec</code></a>, <a href="./#dimensionsspec"><code>dimensionsSpec</code></a>, and <a href="./#metricsspec"><code>metricsSpec</code></a>.<br><br>If false, only explicitly specified fields (see <code>fields</code>) will be available for use.</td>
<td><code>true</code></td>
</tr>
<tr>
<td>fields</td>
<td>Specifies the fields of interest and how they are accessed. <a href="#field-flattening-specifications">See below for details.</a></td>
<td><code>[]</code></td>
</tr>
</tbody>
</table>
<h4 id="field-flattening-specifications"><a name="field-flattening-specifications" class="anchor-navigation-ex-anchor" href="#field-flattening-specifications"><i class="fa fa-link" aria-hidden="true"></i></a>Field flattening specifications</h4>
<p>Each entry in the <code>fields</code> list can have the following components:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>Options are as follows:<br><br><ul><li>`root`, referring to a field at the root level of the record. Only really useful if `useFieldDiscovery` is false.</li><li>`path`, referring to a field using [JsonPath](https://github.com/jayway/JsonPath) notation. Supported by most data formats that offer nesting, including `avro`, `json`, `orc`, and `parquet`.</li><li>`jq`, referring to a field using [jackson-jq](https://github.com/eiiches/jackson-jq) notation. Only supported for the `json` format.</li></ul></td>
<td>none (required)</td>
</tr>
<tr>
<td>name</td>
<td>Name of the field after flattening. This name can be referred to by the <a href="./#timestampspec"><code>timestampSpec</code></a>, <a href="./#transformspec"><code>transformSpec</code></a>, <a href="./#dimensionsspec"><code>dimensionsSpec</code></a>, and <a href="./#metricsspec"><code>metricsSpec</code></a>.</td>
<td>none (required)</td>
</tr>
<tr>
<td>expr</td>
<td>Expression for accessing the field while flattening. For type <code>path</code>, this should be <a href="https://github.com/jayway/JsonPath" target="_blank">JsonPath</a>. For type <code>jq</code>, this should be <a href="https://github.com/eiiches/jackson-jq" target="_blank">jackson-jq</a> notation. For other types, this parameter is ignored.</td>
<td>none (required for types <code>path</code> and <code>jq</code>)</td>
</tr>
</tbody>
</table>
<h4 id="notes-on-flattening"><a name="notes-on-flattening" class="anchor-navigation-ex-anchor" href="#notes-on-flattening"><i class="fa fa-link" aria-hidden="true"></i></a>Notes on flattening</h4>
<ul>
<li>For convenience, when defining a root-level field, it is possible to define only the field name, as a string, instead of a JSON object. For example, <code>{&quot;name&quot;: &quot;baz&quot;, &quot;type&quot;: &quot;root&quot;}</code> is equivalent to <code>&quot;baz&quot;</code>.</li>
<li>Enabling <code>useFieldDiscovery</code> will only automatically detect &quot;simple&quot; fields at the root level that correspond to data types that Druid supports. This includes strings, numbers, and lists of strings or numbers. Other types will not be automatically detected, and must be specified explicitly in the <code>fields</code> list.</li>
<li>Duplicate field <code>name</code>s are not allowed. An exception will be thrown.</li>
<li>If <code>useFieldDiscovery</code> is enabled, any discovered field with the same name as one already defined in the <code>fields</code> list will be skipped, rather than added twice.</li>
<li><a href="http://jsonpath.herokuapp.com/" target="_blank">http://jsonpath.herokuapp.com/</a> is useful for testing <code>path</code>-type expressions.</li>
<li>jackson-jq supports a subset of the full <a href="https://stedolan.github.io/jq/" target="_blank">jq</a> syntax.  Please refer to the <a href="https://github.com/eiiches/jackson-jq" target="_blank">jackson-jq documentation</a> for details.</li>
</ul>
<h2 id="parser"><a name="parser" class="anchor-navigation-ex-anchor" href="#parser"><i class="fa fa-link" aria-hidden="true"></i></a>1.4. Parser</h2>
<blockquote>
<p>The Parser is deprecated for <a href="native-batch.html">native batch tasks</a>, <a href="../development/extensions-core/kafka-ingestion.html">Kafka indexing service</a>,
and <a href="../development/extensions-core/kinesis-ingestion.html">Kinesis indexing service</a>.
Consider using the <a href="#input-format">input format</a> instead for these types of ingestion.</p>
</blockquote>
<p>This section lists all default and core extension parsers.
For community extension parsers, please see our <a href="../development/extensions.html#community-extensions">community extensions list</a>.</p>
<h3 id="string-parser"><a name="string-parser" class="anchor-navigation-ex-anchor" href="#string-parser"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.1. String Parser</h3>
<p><code>string</code> typed parsers operate on text based inputs that can be split into individual records by newlines.
Each line can be further parsed using <a href="#parsespec"><code>parseSpec</code></a>.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>string</code> in general, or <code>hadoopyString</code> when used in a Hadoop indexing job.</td>
<td>yes</td>
</tr>
<tr>
<td>parseSpec</td>
<td>JSON Object</td>
<td>Specifies the format, timestamp, and dimensions of the data.</td>
<td>yes</td>
</tr>
</tbody>
</table>
<h3 id="avro-hadoop-parser"><a name="avro-hadoop-parser" class="anchor-navigation-ex-anchor" href="#avro-hadoop-parser"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.2. Avro Hadoop Parser</h3>
<blockquote>
<p>You need to include the <a href="../development/extensions-core/avro.md"><code>druid-avro-extensions</code></a> as an extension to use the Avro Hadoop Parser.</p>
<p>See the <a href="../development/extensions-core/avro.md#avro-types">Avro Types</a> section for how Avro types are handled in Druid</p>
</blockquote>
<p>This parser is for <a href="hadoop.html">Hadoop batch ingestion</a>.
The <code>inputFormat</code> of <code>inputSpec</code> in <code>ioConfig</code> must be set to <code>&quot;org.apache.druid.data.input.avro.AvroValueInputFormat&quot;</code>.
You may want to set Avro reader&apos;s schema in <code>jobProperties</code> in <code>tuningConfig</code>,
e.g.: <code>&quot;avro.schema.input.value.path&quot;: &quot;/path/to/your/schema.avsc&quot;</code> or
<code>&quot;avro.schema.input.value&quot;: &quot;your_schema_JSON_object&quot;</code>.
If the Avro reader&apos;s schema is not set, the schema in Avro object container file will be used.
See <a href="http://avro.apache.org/docs/1.7.7/spec.html#Schema+Resolution" target="_blank">Avro specification</a> for more information.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>avro_hadoop</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>parseSpec</td>
<td>JSON Object</td>
<td>Specifies the timestamp and dimensions of the data. Should be an &quot;avro&quot; parseSpec.</td>
<td>yes</td>
</tr>
<tr>
<td>fromPigAvroStorage</td>
<td>Boolean</td>
<td>Specifies whether the data file is stored using AvroStorage.</td>
<td>no(default == false)</td>
</tr>
</tbody>
</table>
<p>An Avro parseSpec can contain a <a href="#flattenspec"><code>flattenSpec</code></a> using either the &quot;root&quot; or &quot;path&quot;
field types, which can be used to read nested Avro records. The &quot;jq&quot; field type is not currently supported for Avro.</p>
<p>For example, using Avro Hadoop parser with custom reader&apos;s schema file:</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;index_hadoop&quot;</span>,
  <span class="hljs-string">&quot;spec&quot;</span> : {
    <span class="hljs-string">&quot;dataSchema&quot;</span> : {
      <span class="hljs-string">&quot;dataSource&quot;</span> : <span class="hljs-string">&quot;&quot;</span>,
      <span class="hljs-string">&quot;parser&quot;</span> : {
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;avro_hadoop&quot;</span>,
        <span class="hljs-string">&quot;parseSpec&quot;</span> : {
          <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;avro&quot;</span>,
          <span class="hljs-string">&quot;timestampSpec&quot;</span>: &lt;standard timestampSpec&gt;,
          &quot;dimensionsSpec&quot;: &lt;standard dimensionsSpec&gt;,
          &quot;flattenSpec&quot;: &lt;optional&gt;
        }
      }
    },
    &quot;ioConfig&quot; : {
      &quot;type&quot; : &quot;hadoop&quot;,
      &quot;inputSpec&quot; : {
        &quot;type&quot; : &quot;static&quot;,
        &quot;inputFormat&quot;: &quot;org.apache.druid.data.input.avro.AvroValueInputFormat&quot;,
        &quot;paths&quot; : &quot;&quot;
      }
    },
    &quot;tuningConfig&quot; : {
       &quot;jobProperties&quot; : {
          &quot;avro.schema.input.value.path&quot; : &quot;/path/to/my/schema.avsc&quot;
      }
    }
  }
}
</code></pre>
<h3 id="orc-hadoop-parser"><a name="orc-hadoop-parser" class="anchor-navigation-ex-anchor" href="#orc-hadoop-parser"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.3. ORC Hadoop Parser</h3>
<blockquote>
<p>You need to include the <a href="../development/extensions-core/orc.md"><code>druid-orc-extensions</code></a> as an extension to use the ORC Hadoop Parser.</p>
<p>If you are considering upgrading from earlier than 0.15.0 to 0.15.0 or a higher version,
please read <a href="../development/extensions-core/orc.md#migration-from-contrib-extension">Migration from &apos;contrib&apos; extension</a> carefully.</p>
</blockquote>
<p>This parser is for <a href="hadoop.html">Hadoop batch ingestion</a>.
The <code>inputFormat</code> of <code>inputSpec</code> in <code>ioConfig</code> must be set to <code>&quot;org.apache.orc.mapreduce.OrcInputFormat&quot;</code>.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>orc</code></td>
<td>yes</td>
</tr>
<tr>
<td>parseSpec</td>
<td>JSON Object</td>
<td>Specifies the timestamp and dimensions of the data (<code>timeAndDims</code> and <code>orc</code> format) and a <code>flattenSpec</code> (<code>orc</code> format)</td>
<td>yes</td>
</tr>
</tbody>
</table>
<p>The parser supports two <code>parseSpec</code> formats: <code>orc</code> and <code>timeAndDims</code>.</p>
<p><code>orc</code> supports auto field discovery and flattening, if specified with a <a href="#flattenspec"><code>flattenSpec</code></a>.
If no <code>flattenSpec</code> is specified, <code>useFieldDiscovery</code> will be enabled by default. Specifying a <code>dimensionSpec</code> is
optional if <code>useFieldDiscovery</code> is enabled: if a <code>dimensionSpec</code> is supplied, the list of <code>dimensions</code> it defines will be
the set of ingested dimensions, if missing the discovered fields will make up the list.</p>
<p><code>timeAndDims</code> parse spec must specify which fields will be extracted as dimensions through the <code>dimensionSpec</code>.</p>
<p><a href="https://orc.apache.org/docs/types.md" target="_blank">All column types</a> are supported, with the exception of <code>union</code> types. Columns of
 <code>list</code> type, if filled with primitives, may be used as a multi-value dimension, or specific elements can be extracted with
<code>flattenSpec</code> expressions. Likewise, primitive fields may be extracted from <code>map</code> and <code>struct</code> types in the same manner.
Auto field discovery will automatically create a string dimension for every (non-timestamp) primitive or <code>list</code> of
primitives, as well as any flatten expressions defined in the <code>flattenSpec</code>.</p>
<h4 id="hadoop-job-properties"><a name="hadoop-job-properties" class="anchor-navigation-ex-anchor" href="#hadoop-job-properties"><i class="fa fa-link" aria-hidden="true"></i></a>Hadoop job properties</h4>
<p>Like most Hadoop jobs, the best outcomes will add <code>&quot;mapreduce.job.user.classpath.first&quot;: &quot;true&quot;</code> or
<code>&quot;mapreduce.job.classloader&quot;: &quot;true&quot;</code> to the <code>jobProperties</code> section of <code>tuningConfig</code>. Note that it is likely if using
<code>&quot;mapreduce.job.classloader&quot;: &quot;true&quot;</code> that you will need to set <code>mapreduce.job.classloader.system.classes</code> to include
<code>-org.apache.hadoop.hive.</code> to instruct Hadoop to load <code>org.apache.hadoop.hive</code> classes from the application jars instead
of system jars, e.g.</p>
<pre><code class="lang-json">...
    <span class="hljs-string">&quot;mapreduce.job.classloader&quot;</span>: <span class="hljs-string">&quot;true&quot;</span>,
    <span class="hljs-string">&quot;mapreduce.job.classloader.system.classes&quot;</span> : <span class="hljs-string">&quot;java., javax.accessibility., javax.activation., javax.activity., javax.annotation., javax.annotation.processing., javax.crypto., javax.imageio., javax.jws., javax.lang.model., -javax.management.j2ee., javax.management., javax.naming., javax.net., javax.print., javax.rmi., javax.script., -javax.security.auth.message., javax.security.auth., javax.security.cert., javax.security.sasl., javax.sound., javax.sql., javax.swing., javax.tools., javax.transaction., -javax.xml.registry., -javax.xml.rpc., javax.xml., org.w3c.dom., org.xml.sax., org.apache.commons.logging., org.apache.log4j., -org.apache.hadoop.hbase., -org.apache.hadoop.hive., org.apache.hadoop., core-default.xml, hdfs-default.xml, mapred-default.xml, yarn-default.xml&quot;</span>,
...
</code></pre>
<p>This is due to the <code>hive-storage-api</code> dependency of the
<code>orc-mapreduce</code> library, which provides some classes under the <code>org.apache.hadoop.hive</code> package. If instead using the
setting <code>&quot;mapreduce.job.user.classpath.first&quot;: &quot;true&quot;</code>, then this will not be an issue.</p>
<h4 id="examples"><a name="examples" class="anchor-navigation-ex-anchor" href="#examples"><i class="fa fa-link" aria-hidden="true"></i></a>Examples</h4>
<h5 id="orc-parser-orc-parsespec-auto-field-discovery-flatten-expressions"><a name="orc-parser-orc-parsespec-auto-field-discovery-flatten-expressions" class="anchor-navigation-ex-anchor" href="#orc-parser-orc-parsespec-auto-field-discovery-flatten-expressions"><i class="fa fa-link" aria-hidden="true"></i></a><code>orc</code> parser, <code>orc</code> parseSpec, auto field discovery, flatten expressions</h5>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;index_hadoop&quot;</span>,
  <span class="hljs-string">&quot;spec&quot;</span>: {
    <span class="hljs-string">&quot;ioConfig&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;hadoop&quot;</span>,
      <span class="hljs-string">&quot;inputSpec&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;static&quot;</span>,
        <span class="hljs-string">&quot;inputFormat&quot;</span>: <span class="hljs-string">&quot;org.apache.orc.mapreduce.OrcInputFormat&quot;</span>,
        <span class="hljs-string">&quot;paths&quot;</span>: <span class="hljs-string">&quot;path/to/file.orc&quot;</span>
      },
      ...
    },
    <span class="hljs-string">&quot;dataSchema&quot;</span>: {
      <span class="hljs-string">&quot;dataSource&quot;</span>: <span class="hljs-string">&quot;example&quot;</span>,
      <span class="hljs-string">&quot;parser&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;orc&quot;</span>,
        <span class="hljs-string">&quot;parseSpec&quot;</span>: {
          <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;orc&quot;</span>,
          <span class="hljs-string">&quot;flattenSpec&quot;</span>: {
            <span class="hljs-string">&quot;useFieldDiscovery&quot;</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">&quot;fields&quot;</span>: [
              {
                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;path&quot;</span>,
                <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;nestedDim&quot;</span>,
                <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;$.nestedData.dim1&quot;</span>
              },
              {
                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;path&quot;</span>,
                <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;listDimFirstItem&quot;</span>,
                <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;$.listDim[1]&quot;</span>
              }
            ]
          },
          <span class="hljs-string">&quot;timestampSpec&quot;</span>: {
            <span class="hljs-string">&quot;column&quot;</span>: <span class="hljs-string">&quot;timestamp&quot;</span>,
            <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;millis&quot;</span>
          }
        }
      },
      ...
    },
    <span class="hljs-string">&quot;tuningConfig&quot;</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">hadoop-tuning-config</span>&gt;</span>
    }
  }
}
</span></code></pre>
<h5 id="orc-parser-orc-parsespec-field-discovery-with-no-flattenspec-or-dimensionspec"><a name="orc-parser-orc-parsespec-field-discovery-with-no-flattenspec-or-dimensionspec" class="anchor-navigation-ex-anchor" href="#orc-parser-orc-parsespec-field-discovery-with-no-flattenspec-or-dimensionspec"><i class="fa fa-link" aria-hidden="true"></i></a><code>orc</code> parser, <code>orc</code> parseSpec, field discovery with no flattenSpec or dimensionSpec</h5>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;index_hadoop&quot;</span>,
  <span class="hljs-string">&quot;spec&quot;</span>: {
    <span class="hljs-string">&quot;ioConfig&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;hadoop&quot;</span>,
      <span class="hljs-string">&quot;inputSpec&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;static&quot;</span>,
        <span class="hljs-string">&quot;inputFormat&quot;</span>: <span class="hljs-string">&quot;org.apache.orc.mapreduce.OrcInputFormat&quot;</span>,
        <span class="hljs-string">&quot;paths&quot;</span>: <span class="hljs-string">&quot;path/to/file.orc&quot;</span>
      },
      ...
    },
    <span class="hljs-string">&quot;dataSchema&quot;</span>: {
      <span class="hljs-string">&quot;dataSource&quot;</span>: <span class="hljs-string">&quot;example&quot;</span>,
      <span class="hljs-string">&quot;parser&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;orc&quot;</span>,
        <span class="hljs-string">&quot;parseSpec&quot;</span>: {
          <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;orc&quot;</span>,
          <span class="hljs-string">&quot;timestampSpec&quot;</span>: {
            <span class="hljs-string">&quot;column&quot;</span>: <span class="hljs-string">&quot;timestamp&quot;</span>,
            <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;millis&quot;</span>
          }
        }
      },
      ...
    },
    <span class="hljs-string">&quot;tuningConfig&quot;</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">hadoop-tuning-config</span>&gt;</span>
    }
  }
}
</span></code></pre>
<h5 id="orc-parser-orc-parsespec-no-autodiscovery"><a name="orc-parser-orc-parsespec-no-autodiscovery" class="anchor-navigation-ex-anchor" href="#orc-parser-orc-parsespec-no-autodiscovery"><i class="fa fa-link" aria-hidden="true"></i></a><code>orc</code> parser, <code>orc</code> parseSpec, no autodiscovery</h5>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;index_hadoop&quot;</span>,
  <span class="hljs-string">&quot;spec&quot;</span>: {
    <span class="hljs-string">&quot;ioConfig&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;hadoop&quot;</span>,
      <span class="hljs-string">&quot;inputSpec&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;static&quot;</span>,
        <span class="hljs-string">&quot;inputFormat&quot;</span>: <span class="hljs-string">&quot;org.apache.orc.mapreduce.OrcInputFormat&quot;</span>,
        <span class="hljs-string">&quot;paths&quot;</span>: <span class="hljs-string">&quot;path/to/file.orc&quot;</span>
      },
      ...
    },
    <span class="hljs-string">&quot;dataSchema&quot;</span>: {
      <span class="hljs-string">&quot;dataSource&quot;</span>: <span class="hljs-string">&quot;example&quot;</span>,
      <span class="hljs-string">&quot;parser&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;orc&quot;</span>,
        <span class="hljs-string">&quot;parseSpec&quot;</span>: {
          <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;orc&quot;</span>,
          <span class="hljs-string">&quot;flattenSpec&quot;</span>: {
            <span class="hljs-string">&quot;useFieldDiscovery&quot;</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-string">&quot;fields&quot;</span>: [
              {
                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;path&quot;</span>,
                <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;nestedDim&quot;</span>,
                <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;$.nestedData.dim1&quot;</span>
              },
              {
                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;path&quot;</span>,
                <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;listDimFirstItem&quot;</span>,
                <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;$.listDim[1]&quot;</span>
              }
            ]
          },
          <span class="hljs-string">&quot;timestampSpec&quot;</span>: {
            <span class="hljs-string">&quot;column&quot;</span>: <span class="hljs-string">&quot;timestamp&quot;</span>,
            <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;millis&quot;</span>
          },
          <span class="hljs-string">&quot;dimensionsSpec&quot;</span>: {
            <span class="hljs-string">&quot;dimensions&quot;</span>: [
              <span class="hljs-string">&quot;dim1&quot;</span>,
              <span class="hljs-string">&quot;dim3&quot;</span>,
              <span class="hljs-string">&quot;nestedDim&quot;</span>,
              <span class="hljs-string">&quot;listDimFirstItem&quot;</span>
            ],
            <span class="hljs-string">&quot;dimensionExclusions&quot;</span>: [],
            <span class="hljs-string">&quot;spatialDimensions&quot;</span>: []
          }
        }
      },
      ...
    },
    <span class="hljs-string">&quot;tuningConfig&quot;</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">hadoop-tuning-config</span>&gt;</span>
    }
  }
}
</span></code></pre>
<h5 id="orc-parser-timeanddims-parsespec"><a name="orc-parser-timeanddims-parsespec" class="anchor-navigation-ex-anchor" href="#orc-parser-timeanddims-parsespec"><i class="fa fa-link" aria-hidden="true"></i></a><code>orc</code> parser, <code>timeAndDims</code> parseSpec</h5>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;index_hadoop&quot;</span>,
  <span class="hljs-string">&quot;spec&quot;</span>: {
    <span class="hljs-string">&quot;ioConfig&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;hadoop&quot;</span>,
      <span class="hljs-string">&quot;inputSpec&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;static&quot;</span>,
        <span class="hljs-string">&quot;inputFormat&quot;</span>: <span class="hljs-string">&quot;org.apache.orc.mapreduce.OrcInputFormat&quot;</span>,
        <span class="hljs-string">&quot;paths&quot;</span>: <span class="hljs-string">&quot;path/to/file.orc&quot;</span>
      },
      ...
    },
    <span class="hljs-string">&quot;dataSchema&quot;</span>: {
      <span class="hljs-string">&quot;dataSource&quot;</span>: <span class="hljs-string">&quot;example&quot;</span>,
      <span class="hljs-string">&quot;parser&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;orc&quot;</span>,
        <span class="hljs-string">&quot;parseSpec&quot;</span>: {
          <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;timeAndDims&quot;</span>,
          <span class="hljs-string">&quot;timestampSpec&quot;</span>: {
            <span class="hljs-string">&quot;column&quot;</span>: <span class="hljs-string">&quot;timestamp&quot;</span>,
            <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;auto&quot;</span>
          },
          <span class="hljs-string">&quot;dimensionsSpec&quot;</span>: {
            <span class="hljs-string">&quot;dimensions&quot;</span>: [
              <span class="hljs-string">&quot;dim1&quot;</span>,
              <span class="hljs-string">&quot;dim2&quot;</span>,
              <span class="hljs-string">&quot;dim3&quot;</span>,
              <span class="hljs-string">&quot;listDim&quot;</span>
            ],
            <span class="hljs-string">&quot;dimensionExclusions&quot;</span>: [],
            <span class="hljs-string">&quot;spatialDimensions&quot;</span>: []
          }
        }
      },
      ...
    },
    <span class="hljs-string">&quot;tuningConfig&quot;</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">hadoop-tuning-config</span>&gt;</span>
  }
}
</span></code></pre>
<h3 id="parquet-hadoop-parser"><a name="parquet-hadoop-parser" class="anchor-navigation-ex-anchor" href="#parquet-hadoop-parser"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.4. Parquet Hadoop Parser</h3>
<blockquote>
<p>You need to include the <a href="../development/extensions-core/parquet.md"><code>druid-parquet-extensions</code></a> as an extension to use the Parquet Hadoop Parser.</p>
</blockquote>
<p>The Parquet Hadoop parser is for <a href="hadoop.html">Hadoop batch ingestion</a> and parses Parquet files directly.
The <code>inputFormat</code> of <code>inputSpec</code> in <code>ioConfig</code> must be set to <code>org.apache.druid.data.input.parquet.DruidParquetInputFormat</code>.</p>
<p>The Parquet Hadoop Parser supports auto field discovery and flattening if provided with a
<a href="#flattenspec"><code>flattenSpec</code></a> with the <code>parquet</code> <code>parseSpec</code>. Parquet nested list and map
<a href="https://github.com/apache/parquet-format/blob/master/LogicalTypes.md" target="_blank">logical types</a> <em>should</em> operate correctly with
JSON path expressions for all supported types.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>parquet</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>parseSpec</td>
<td>JSON Object</td>
<td>Specifies the timestamp and dimensions of the data, and optionally, a flatten spec. Valid parseSpec formats are <code>timeAndDims</code> and <code>parquet</code></td>
<td>yes</td>
</tr>
<tr>
<td>binaryAsString</td>
<td>Boolean</td>
<td>Specifies if the bytes parquet column which is not logically marked as a string or enum type should be treated as a UTF-8 encoded string.</td>
<td>no(default = false)</td>
</tr>
</tbody>
</table>
<p>When the time dimension is a <a href="https://github.com/apache/parquet-format/blob/master/LogicalTypes.md" target="_blank">DateType column</a>,
a format should not be supplied. When the format is UTF8 (String), either <code>auto</code> or a explicitly defined
<a href="http://www.joda.org/joda-time/apidocs/org/joda/time/format/DateTimeFormat" target="_blank">format</a> is required.</p>
<h4 id="parquet-hadoop-parser-vs-parquet-avro-hadoop-parser"><a name="parquet-hadoop-parser-vs-parquet-avro-hadoop-parser" class="anchor-navigation-ex-anchor" href="#parquet-hadoop-parser-vs-parquet-avro-hadoop-parser"><i class="fa fa-link" aria-hidden="true"></i></a>Parquet Hadoop Parser vs Parquet Avro Hadoop Parser</h4>
<p>Both parsers read from Parquet files, but slightly differently. The main
differences are:</p>
<ul>
<li>The Parquet Hadoop Parser uses a simple conversion while the Parquet Avro Hadoop Parser
converts Parquet data into avro records first with the <code>parquet-avro</code> library and then
parses avro data using the <code>druid-avro-extensions</code> module to ingest into Druid.</li>
<li>The Parquet Hadoop Parser sets a hadoop job property
<code>parquet.avro.add-list-element-records</code> to <code>false</code> (which normally defaults to <code>true</code>), in order to &apos;unwrap&apos; primitive
list elements into multi-value dimensions.</li>
<li>The Parquet Hadoop Parser supports <code>int96</code> Parquet values, while the Parquet Avro Hadoop Parser does not.
There may also be some subtle differences in the behavior of JSON path expression evaluation of <code>flattenSpec</code>.</li>
</ul>
<p>Based on those differences, we suggest using the Parquet Hadoop Parser over the Parquet Avro Hadoop Parser
to allow ingesting data beyond the schema constraints of Avro conversion.
However, the Parquet Avro Hadoop Parser was the original basis for supporting the Parquet format, and as such it is a bit more mature.</p>
<h4 id="examples_1"><a name="examples_1" class="anchor-navigation-ex-anchor" href="#examples_1"><i class="fa fa-link" aria-hidden="true"></i></a>Examples</h4>
<h5 id="parquet-parser-parquet-parsespec"><a name="parquet-parser-parquet-parsespec" class="anchor-navigation-ex-anchor" href="#parquet-parser-parquet-parsespec"><i class="fa fa-link" aria-hidden="true"></i></a><code>parquet</code> parser, <code>parquet</code> parseSpec</h5>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;index_hadoop&quot;</span>,
  <span class="hljs-string">&quot;spec&quot;</span>: {
    <span class="hljs-string">&quot;ioConfig&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;hadoop&quot;</span>,
      <span class="hljs-string">&quot;inputSpec&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;static&quot;</span>,
        <span class="hljs-string">&quot;inputFormat&quot;</span>: <span class="hljs-string">&quot;org.apache.druid.data.input.parquet.DruidParquetInputFormat&quot;</span>,
        <span class="hljs-string">&quot;paths&quot;</span>: <span class="hljs-string">&quot;path/to/file.parquet&quot;</span>
      },
      ...
    },
    <span class="hljs-string">&quot;dataSchema&quot;</span>: {
      <span class="hljs-string">&quot;dataSource&quot;</span>: <span class="hljs-string">&quot;example&quot;</span>,
      <span class="hljs-string">&quot;parser&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;parquet&quot;</span>,
        <span class="hljs-string">&quot;parseSpec&quot;</span>: {
          <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;parquet&quot;</span>,
          <span class="hljs-string">&quot;flattenSpec&quot;</span>: {
            <span class="hljs-string">&quot;useFieldDiscovery&quot;</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">&quot;fields&quot;</span>: [
              {
                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;path&quot;</span>,
                <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;nestedDim&quot;</span>,
                <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;$.nestedData.dim1&quot;</span>
              },
              {
                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;path&quot;</span>,
                <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;listDimFirstItem&quot;</span>,
                <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;$.listDim[1]&quot;</span>
              }
            ]
          },
          <span class="hljs-string">&quot;timestampSpec&quot;</span>: {
            <span class="hljs-string">&quot;column&quot;</span>: <span class="hljs-string">&quot;timestamp&quot;</span>,
            <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;auto&quot;</span>
          },
          <span class="hljs-string">&quot;dimensionsSpec&quot;</span>: {
            <span class="hljs-string">&quot;dimensions&quot;</span>: [],
            <span class="hljs-string">&quot;dimensionExclusions&quot;</span>: [],
            <span class="hljs-string">&quot;spatialDimensions&quot;</span>: []
          }
        }
      },
      ...
    },
    <span class="hljs-string">&quot;tuningConfig&quot;</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">hadoop-tuning-config</span>&gt;</span>
    }
  }
}
</span></code></pre>
<h5 id="parquet-parser-timeanddims-parsespec"><a name="parquet-parser-timeanddims-parsespec" class="anchor-navigation-ex-anchor" href="#parquet-parser-timeanddims-parsespec"><i class="fa fa-link" aria-hidden="true"></i></a><code>parquet</code> parser, <code>timeAndDims</code> parseSpec</h5>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;index_hadoop&quot;</span>,
  <span class="hljs-string">&quot;spec&quot;</span>: {
    <span class="hljs-string">&quot;ioConfig&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;hadoop&quot;</span>,
      <span class="hljs-string">&quot;inputSpec&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;static&quot;</span>,
        <span class="hljs-string">&quot;inputFormat&quot;</span>: <span class="hljs-string">&quot;org.apache.druid.data.input.parquet.DruidParquetInputFormat&quot;</span>,
        <span class="hljs-string">&quot;paths&quot;</span>: <span class="hljs-string">&quot;path/to/file.parquet&quot;</span>
      },
      ...
    },
    <span class="hljs-string">&quot;dataSchema&quot;</span>: {
      <span class="hljs-string">&quot;dataSource&quot;</span>: <span class="hljs-string">&quot;example&quot;</span>,
      <span class="hljs-string">&quot;parser&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;parquet&quot;</span>,
        <span class="hljs-string">&quot;parseSpec&quot;</span>: {
          <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;timeAndDims&quot;</span>,
          <span class="hljs-string">&quot;timestampSpec&quot;</span>: {
            <span class="hljs-string">&quot;column&quot;</span>: <span class="hljs-string">&quot;timestamp&quot;</span>,
            <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;auto&quot;</span>
          },
          <span class="hljs-string">&quot;dimensionsSpec&quot;</span>: {
            <span class="hljs-string">&quot;dimensions&quot;</span>: [
              <span class="hljs-string">&quot;dim1&quot;</span>,
              <span class="hljs-string">&quot;dim2&quot;</span>,
              <span class="hljs-string">&quot;dim3&quot;</span>,
              <span class="hljs-string">&quot;listDim&quot;</span>
            ],
            <span class="hljs-string">&quot;dimensionExclusions&quot;</span>: [],
            <span class="hljs-string">&quot;spatialDimensions&quot;</span>: []
          }
        }
      },
      ...
    },
    <span class="hljs-string">&quot;tuningConfig&quot;</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">hadoop-tuning-config</span>&gt;</span>
  }
}
</span></code></pre>
<h3 id="parquet-avro-hadoop-parser"><a name="parquet-avro-hadoop-parser" class="anchor-navigation-ex-anchor" href="#parquet-avro-hadoop-parser"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.5. Parquet Avro Hadoop Parser</h3>
<blockquote>
<p>Consider using the <a href="#parquet-hadoop-parser">Parquet Hadoop Parser</a> over this parser to ingest
Parquet files. See <a href="#parquet-hadoop-parser-vs-parquet-avro-hadoop-parser">Parquet Hadoop Parser vs Parquet Avro Hadoop Parser</a>
for the differences between those parsers.</p>
<p>You need to include both the <a href="../development/extensions-core/parquet.md"><code>druid-parquet-extensions</code></a>
[<code>druid-avro-extensions</code>] as extensions to use the Parquet Avro Hadoop Parser.</p>
</blockquote>
<p>The Parquet Avro Hadoop Parser is for <a href="hadoop.html">Hadoop batch ingestion</a>.
This parser first converts the Parquet data into Avro records, and then parses them to ingest into Druid.
The <code>inputFormat</code> of <code>inputSpec</code> in <code>ioConfig</code> must be set to <code>org.apache.druid.data.input.parquet.DruidParquetAvroInputFormat</code>.</p>
<p>The Parquet Avro Hadoop Parser supports auto field discovery and flattening if provided with a
<a href="#flattenspec"><code>flattenSpec</code></a> with the <code>avro</code> <code>parseSpec</code>. Parquet nested list and map
<a href="https://github.com/apache/parquet-format/blob/master/LogicalTypes.md" target="_blank">logical types</a> <em>should</em> operate correctly with
JSON path expressions for all supported types. This parser sets a hadoop job property
<code>parquet.avro.add-list-element-records</code> to <code>false</code> (which normally defaults to <code>true</code>), in order to &apos;unwrap&apos; primitive
list elements into multi-value dimensions.</p>
<p>Note that the <code>int96</code> Parquet value type is not supported with this parser.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>parquet-avro</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>parseSpec</td>
<td>JSON Object</td>
<td>Specifies the timestamp and dimensions of the data, and optionally, a flatten spec. Should be <code>avro</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>binaryAsString</td>
<td>Boolean</td>
<td>Specifies if the bytes parquet column which is not logically marked as a string or enum type should be treated as a UTF-8 encoded string.</td>
<td>no(default = false)</td>
</tr>
</tbody>
</table>
<p>When the time dimension is a <a href="https://github.com/apache/parquet-format/blob/master/LogicalTypes.md" target="_blank">DateType column</a>,
a format should not be supplied. When the format is UTF8 (String), either <code>auto</code> or
an explicitly defined <a href="http://www.joda.org/joda-time/apidocs/org/joda/time/format/DateTimeFormat" target="_blank">format</a> is required.</p>
<h4 id="example"><a name="example" class="anchor-navigation-ex-anchor" href="#example"><i class="fa fa-link" aria-hidden="true"></i></a>Example</h4>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;index_hadoop&quot;</span>,
  <span class="hljs-string">&quot;spec&quot;</span>: {
    <span class="hljs-string">&quot;ioConfig&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;hadoop&quot;</span>,
      <span class="hljs-string">&quot;inputSpec&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;static&quot;</span>,
        <span class="hljs-string">&quot;inputFormat&quot;</span>: <span class="hljs-string">&quot;org.apache.druid.data.input.parquet.DruidParquetAvroInputFormat&quot;</span>,
        <span class="hljs-string">&quot;paths&quot;</span>: <span class="hljs-string">&quot;path/to/file.parquet&quot;</span>
      },
      ...
    },
    <span class="hljs-string">&quot;dataSchema&quot;</span>: {
      <span class="hljs-string">&quot;dataSource&quot;</span>: <span class="hljs-string">&quot;example&quot;</span>,
      <span class="hljs-string">&quot;parser&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;parquet-avro&quot;</span>,
        <span class="hljs-string">&quot;parseSpec&quot;</span>: {
          <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;avro&quot;</span>,
          <span class="hljs-string">&quot;flattenSpec&quot;</span>: {
            <span class="hljs-string">&quot;useFieldDiscovery&quot;</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">&quot;fields&quot;</span>: [
              {
                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;path&quot;</span>,
                <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;nestedDim&quot;</span>,
                <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;$.nestedData.dim1&quot;</span>
              },
              {
                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;path&quot;</span>,
                <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;listDimFirstItem&quot;</span>,
                <span class="hljs-string">&quot;expr&quot;</span>: <span class="hljs-string">&quot;$.listDim[1]&quot;</span>
              }
            ]
          },
          <span class="hljs-string">&quot;timestampSpec&quot;</span>: {
            <span class="hljs-string">&quot;column&quot;</span>: <span class="hljs-string">&quot;timestamp&quot;</span>,
            <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;auto&quot;</span>
          },
          <span class="hljs-string">&quot;dimensionsSpec&quot;</span>: {
            <span class="hljs-string">&quot;dimensions&quot;</span>: [],
            <span class="hljs-string">&quot;dimensionExclusions&quot;</span>: [],
            <span class="hljs-string">&quot;spatialDimensions&quot;</span>: []
          }
        }
      },
      ...
    },
    <span class="hljs-string">&quot;tuningConfig&quot;</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">hadoop-tuning-config</span>&gt;</span>
    }
  }
}
</span></code></pre>
<h3 id="avro-stream-parser"><a name="avro-stream-parser" class="anchor-navigation-ex-anchor" href="#avro-stream-parser"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.6. Avro Stream Parser</h3>
<blockquote>
<p>You need to include the <a href="../development/extensions-core/avro.md"><code>druid-avro-extensions</code></a> as an extension to use the Avro Stream Parser.</p>
<p>See the <a href="../development/extensions-core/avro.md#avro-types">Avro Types</a> section for how Avro types are handled in Druid</p>
</blockquote>
<p>This parser is for <a href="./#streaming">stream ingestion</a> and reads Avro data from a stream directly.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>avro_stream</code>.</td>
<td>no</td>
</tr>
<tr>
<td>avroBytesDecoder</td>
<td>JSON Object</td>
<td>Specifies how to decode bytes to Avro record.</td>
<td>yes</td>
</tr>
<tr>
<td>parseSpec</td>
<td>JSON Object</td>
<td>Specifies the timestamp and dimensions of the data. Should be an &quot;avro&quot; parseSpec.</td>
<td>yes</td>
</tr>
</tbody>
</table>
<p>An Avro parseSpec can contain a <a href="#flattenspec"><code>flattenSpec</code></a> using either the &quot;root&quot; or &quot;path&quot;
field types, which can be used to read nested Avro records. The &quot;jq&quot; field type is not currently supported for Avro.</p>
<p>For example, using Avro stream parser with schema repo Avro bytes decoder:</p>
<pre><code class="lang-json"><span class="hljs-string">&quot;parser&quot;</span> : {
  <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;avro_stream&quot;</span>,
  <span class="hljs-string">&quot;avroBytesDecoder&quot;</span> : {
    <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;schema_repo&quot;</span>,
    <span class="hljs-string">&quot;subjectAndIdConverter&quot;</span> : {
      <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;avro_1124&quot;</span>,
      <span class="hljs-string">&quot;topic&quot;</span> : <span class="hljs-string">&quot;${YOUR_TOPIC}&quot;</span>
    },
    <span class="hljs-string">&quot;schemaRepository&quot;</span> : {
      <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;avro_1124_rest_client&quot;</span>,
      <span class="hljs-string">&quot;url&quot;</span> : <span class="hljs-string">&quot;${YOUR_SCHEMA_REPO_END_POINT}&quot;</span>,
    }
  },
  <span class="hljs-string">&quot;parseSpec&quot;</span> : {
    <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;avro&quot;</span>,
    <span class="hljs-string">&quot;timestampSpec&quot;</span>: &lt;standard timestampSpec&gt;,
    &quot;dimensionsSpec&quot;: &lt;standard dimensionsSpec&gt;,
    &quot;flattenSpec&quot;: &lt;optional&gt;
  }
}
</code></pre>
<h4 id="avro-bytes-decoder"><a name="avro-bytes-decoder" class="anchor-navigation-ex-anchor" href="#avro-bytes-decoder"><i class="fa fa-link" aria-hidden="true"></i></a>Avro Bytes Decoder</h4>
<p>If <code>type</code> is not included, the avroBytesDecoder defaults to <code>schema_repo</code>.</p>
<h5 id="inline-schema-based-avro-bytes-decoder"><a name="inline-schema-based-avro-bytes-decoder" class="anchor-navigation-ex-anchor" href="#inline-schema-based-avro-bytes-decoder"><i class="fa fa-link" aria-hidden="true"></i></a>Inline Schema Based Avro Bytes Decoder</h5>
<blockquote>
<p>The &quot;schema_inline&quot; decoder reads Avro records using a fixed schema and does not support schema migration. If you
may need to migrate schemas in the future, consider one of the other decoders, all of which use a message header that
allows the parser to identify the proper Avro schema for reading records.</p>
</blockquote>
<p>This decoder can be used if all the input events can be read using the same schema. In this case, specify the schema in the input task JSON itself, as described below.</p>
<pre><code>...
&quot;avroBytesDecoder&quot;: {
  &quot;type&quot;: &quot;schema_inline&quot;,
  &quot;schema&quot;: {
    //your schema goes here, for example
    &quot;namespace&quot;: &quot;org.apache.druid.data&quot;,
    &quot;name&quot;: &quot;User&quot;,
    &quot;type&quot;: &quot;record&quot;,
    &quot;fields&quot;: [
      { &quot;name&quot;: &quot;FullName&quot;, &quot;type&quot;: &quot;string&quot; },
      { &quot;name&quot;: &quot;Country&quot;, &quot;type&quot;: &quot;string&quot; }
    ]
  }
}
...
</code></pre><h5 id="multiple-inline-schemas-based-avro-bytes-decoder"><a name="multiple-inline-schemas-based-avro-bytes-decoder" class="anchor-navigation-ex-anchor" href="#multiple-inline-schemas-based-avro-bytes-decoder"><i class="fa fa-link" aria-hidden="true"></i></a>Multiple Inline Schemas Based Avro Bytes Decoder</h5>
<p>Use this decoder if different input events can have different read schemas. In this case, specify the schema in the input task JSON itself, as described below.</p>
<pre><code>...
&quot;avroBytesDecoder&quot;: {
  &quot;type&quot;: &quot;multiple_schemas_inline&quot;,
  &quot;schemas&quot;: {
    //your id -&gt; schema map goes here, for example
    &quot;1&quot;: {
      &quot;namespace&quot;: &quot;org.apache.druid.data&quot;,
      &quot;name&quot;: &quot;User&quot;,
      &quot;type&quot;: &quot;record&quot;,
      &quot;fields&quot;: [
        { &quot;name&quot;: &quot;FullName&quot;, &quot;type&quot;: &quot;string&quot; },
        { &quot;name&quot;: &quot;Country&quot;, &quot;type&quot;: &quot;string&quot; }
      ]
    },
    &quot;2&quot;: {
      &quot;namespace&quot;: &quot;org.apache.druid.otherdata&quot;,
      &quot;name&quot;: &quot;UserIdentity&quot;,
      &quot;type&quot;: &quot;record&quot;,
      &quot;fields&quot;: [
        { &quot;name&quot;: &quot;Name&quot;, &quot;type&quot;: &quot;string&quot; },
        { &quot;name&quot;: &quot;Location&quot;, &quot;type&quot;: &quot;string&quot; }
      ]
    },
    ...
    ...
  }
}
...
</code></pre><p>Note that it is essentially a map of integer schema ID to avro schema object. This parser assumes that record has following format.
  first 1 byte is version and must always be 1.
  next 4 bytes are integer schema ID serialized using big-endian byte order.
  remaining bytes contain serialized avro message.</p>
<h5 id="schemarepo-based-avro-bytes-decoder"><a name="schemarepo-based-avro-bytes-decoder" class="anchor-navigation-ex-anchor" href="#schemarepo-based-avro-bytes-decoder"><i class="fa fa-link" aria-hidden="true"></i></a>SchemaRepo Based Avro Bytes Decoder</h5>
<p>This Avro bytes decoder first extracts <code>subject</code> and <code>id</code> from the input message bytes, and then uses them to look up the Avro schema used to decode the Avro record from bytes. For details, see the <a href="https://github.com/schema-repo/schema-repo" target="_blank">schema repo</a> and <a href="https://issues.apache.org/jira/browse/AVRO-1124" target="_blank">AVRO-1124</a>. You will need an http service like schema repo to hold the avro schema. For information on registering a schema on the message producer side, see <code>org.apache.druid.data.input.AvroStreamInputRowParserTest#testParse()</code>.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>schema_repo</code>.</td>
<td>no</td>
</tr>
<tr>
<td>subjectAndIdConverter</td>
<td>JSON Object</td>
<td>Specifies how to extract the subject and id from message bytes.</td>
<td>yes</td>
</tr>
<tr>
<td>schemaRepository</td>
<td>JSON Object</td>
<td>Specifies how to look up the Avro schema from subject and id.</td>
<td>yes</td>
</tr>
</tbody>
</table>
<h6 id="avro-1124-subject-and-id-converter"><a name="avro-1124-subject-and-id-converter" class="anchor-navigation-ex-anchor" href="#avro-1124-subject-and-id-converter"><i class="fa fa-link" aria-hidden="true"></i></a>Avro-1124 Subject And Id Converter</h6>
<p>This section describes the format of the <code>subjectAndIdConverter</code> object for the <code>schema_repo</code> Avro bytes decoder.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>avro_1124</code>.</td>
<td>no</td>
</tr>
<tr>
<td>topic</td>
<td>String</td>
<td>Specifies the topic of your Kafka stream.</td>
<td>yes</td>
</tr>
</tbody>
</table>
<h6 id="avro-1124-schema-repository"><a name="avro-1124-schema-repository" class="anchor-navigation-ex-anchor" href="#avro-1124-schema-repository"><i class="fa fa-link" aria-hidden="true"></i></a>Avro-1124 Schema Repository</h6>
<p>This section describes the format of the <code>schemaRepository</code> object for the <code>schema_repo</code> Avro bytes decoder.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>avro_1124_rest_client</code>.</td>
<td>no</td>
</tr>
<tr>
<td>url</td>
<td>String</td>
<td>Specifies the endpoint url of your Avro-1124 schema repository.</td>
<td>yes</td>
</tr>
</tbody>
</table>
<h5 id="confluent-schema-registry-based-avro-bytes-decoder"><a name="confluent-schema-registry-based-avro-bytes-decoder" class="anchor-navigation-ex-anchor" href="#confluent-schema-registry-based-avro-bytes-decoder"><i class="fa fa-link" aria-hidden="true"></i></a>Confluent Schema Registry-based Avro Bytes Decoder</h5>
<p>This Avro bytes decoder first extracts a unique <code>id</code> from input message bytes, and then uses it to look up the schema in the Schema Registry used to decode the Avro record from bytes.
For details, see the Schema Registry <a href="http://docs.confluent.io/current/schema-registry/docs/" target="_blank">documentation</a> and <a href="https://github.com/confluentinc/schema-registry" target="_blank">repository</a>.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>schema_registry</code>.</td>
<td>no</td>
</tr>
<tr>
<td>url</td>
<td>String</td>
<td>Specifies the url endpoint of the Schema Registry.</td>
<td>yes</td>
</tr>
<tr>
<td>capacity</td>
<td>Integer</td>
<td>Specifies the max size of the cache (default = Integer.MAX_VALUE).</td>
<td>no</td>
</tr>
</tbody>
</table>
<pre><code class="lang-json">...
<span class="hljs-string">&quot;avroBytesDecoder&quot;</span> : {
   <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;schema_registry&quot;</span>,
   <span class="hljs-string">&quot;url&quot;</span> : <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">schema-registry-url</span>&gt;</span>
}
...
</span></code></pre>
<h3 id="protobuf-parser"><a name="protobuf-parser" class="anchor-navigation-ex-anchor" href="#protobuf-parser"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.7. Protobuf Parser</h3>
<blockquote>
<p>You need to include the <a href="../development/extensions-core/protobuf.md"><code>druid-protobuf-extensions</code></a> as an extension to use the Protobuf Parser.</p>
</blockquote>
<p>This parser is for <a href="./#streaming">stream ingestion</a> and reads Protocol buffer data from a stream directly.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>This should say <code>protobuf</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>descriptor</td>
<td>String</td>
<td>Protobuf descriptor file name in the classpath or URL.</td>
<td>yes</td>
</tr>
<tr>
<td>protoMessageType</td>
<td>String</td>
<td>Protobuf message type in the descriptor.  Both short name and fully qualified name are accepted.  The parser uses the first message type found in the descriptor if not specified.</td>
<td>no</td>
</tr>
<tr>
<td>parseSpec</td>
<td>JSON Object</td>
<td>Specifies the timestamp and dimensions of the data.  The format must be JSON. See <a href="./">JSON ParseSpec</a> for more configuration options.  Note that timeAndDims parseSpec is no longer supported.</td>
<td>yes</td>
</tr>
</tbody>
</table>
<p>Sample spec:</p>
<pre><code class="lang-json"><span class="hljs-string">&quot;parser&quot;</span>: {
  <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;protobuf&quot;</span>,
  <span class="hljs-string">&quot;descriptor&quot;</span>: <span class="hljs-string">&quot;file:///tmp/metrics.desc&quot;</span>,
  <span class="hljs-string">&quot;protoMessageType&quot;</span>: <span class="hljs-string">&quot;Metrics&quot;</span>,
  <span class="hljs-string">&quot;parseSpec&quot;</span>: {
    <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;json&quot;</span>,
    <span class="hljs-string">&quot;timestampSpec&quot;</span>: {
      <span class="hljs-string">&quot;column&quot;</span>: <span class="hljs-string">&quot;timestamp&quot;</span>,
      <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;auto&quot;</span>
    },
    <span class="hljs-string">&quot;dimensionsSpec&quot;</span>: {
      <span class="hljs-string">&quot;dimensions&quot;</span>: [
        <span class="hljs-string">&quot;unit&quot;</span>,
        <span class="hljs-string">&quot;http_method&quot;</span>,
        <span class="hljs-string">&quot;http_code&quot;</span>,
        <span class="hljs-string">&quot;page&quot;</span>,
        <span class="hljs-string">&quot;metricType&quot;</span>,
        <span class="hljs-string">&quot;server&quot;</span>
      ],
      <span class="hljs-string">&quot;dimensionExclusions&quot;</span>: [
        <span class="hljs-string">&quot;timestamp&quot;</span>,
        <span class="hljs-string">&quot;value&quot;</span>
      ]
    }
  }
}
</code></pre>
<p>See the <a href="../development/extensions-core/protobuf.md">extension description</a> for
more details and examples.</p>
<h2 id="parsespec"><a name="parsespec" class="anchor-navigation-ex-anchor" href="#parsespec"><i class="fa fa-link" aria-hidden="true"></i></a>1.5. ParseSpec</h2>
<blockquote>
<p>The Parser is deprecated for <a href="native-batch.html">native batch tasks</a>, <a href="../development/extensions-core/kafka-ingestion.html">Kafka indexing service</a>,
and <a href="../development/extensions-core/kinesis-ingestion.html">Kinesis indexing service</a>.
Consider using the <a href="#input-format">input format</a> instead for these types of ingestion.</p>
</blockquote>
<p>ParseSpecs serve two purposes:</p>
<ul>
<li>The String Parser use them to determine the format (i.e., JSON, CSV, TSV) of incoming rows.</li>
<li>All Parsers use them to determine the timestamp and dimensions of incoming rows.</li>
</ul>
<p>If <code>format</code> is not included, the parseSpec defaults to <code>tsv</code>.</p>
<h3 id="json-parsespec"><a name="json-parsespec" class="anchor-navigation-ex-anchor" href="#json-parsespec"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.1. JSON ParseSpec</h3>
<p>Use this with the String Parser to load JSON.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>format</td>
<td>String</td>
<td>This should say <code>json</code>.</td>
<td>no</td>
</tr>
<tr>
<td>timestampSpec</td>
<td>JSON Object</td>
<td>Specifies the column and format of the timestamp.</td>
<td>yes</td>
</tr>
<tr>
<td>dimensionsSpec</td>
<td>JSON Object</td>
<td>Specifies the dimensions of the data.</td>
<td>yes</td>
</tr>
<tr>
<td>flattenSpec</td>
<td>JSON Object</td>
<td>Specifies flattening configuration for nested JSON data. See <a href="#flattenspec"><code>flattenSpec</code></a> for more info.</td>
<td>no</td>
</tr>
</tbody>
</table>
<p>Sample spec:</p>
<pre><code class="lang-json"><span class="hljs-string">&quot;parseSpec&quot;</span>: {
  <span class="hljs-string">&quot;format&quot;</span> : <span class="hljs-string">&quot;json&quot;</span>,
  <span class="hljs-string">&quot;timestampSpec&quot;</span> : {
    <span class="hljs-string">&quot;column&quot;</span> : <span class="hljs-string">&quot;timestamp&quot;</span>
  },
  <span class="hljs-string">&quot;dimensionSpec&quot;</span> : {
    <span class="hljs-string">&quot;dimensions&quot;</span> : [<span class="hljs-string">&quot;page&quot;</span>,<span class="hljs-string">&quot;language&quot;</span>,<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-string">&quot;unpatrolled&quot;</span>,<span class="hljs-string">&quot;newPage&quot;</span>,<span class="hljs-string">&quot;robot&quot;</span>,<span class="hljs-string">&quot;anonymous&quot;</span>,<span class="hljs-string">&quot;namespace&quot;</span>,<span class="hljs-string">&quot;continent&quot;</span>,<span class="hljs-string">&quot;country&quot;</span>,<span class="hljs-string">&quot;region&quot;</span>,<span class="hljs-string">&quot;city&quot;</span>]
  }
}
</code></pre>
<h3 id="json-lowercase-parsespec"><a name="json-lowercase-parsespec" class="anchor-navigation-ex-anchor" href="#json-lowercase-parsespec"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.2. JSON Lowercase ParseSpec</h3>
<blockquote>
<p>The <em>jsonLowercase</em> parser is deprecated and may be removed in a future version of Druid.</p>
</blockquote>
<p>This is a special variation of the JSON ParseSpec that lower cases all the column names in the incoming JSON data. This parseSpec is required if you are updating to Druid 0.7.x from Druid 0.6.x, are directly ingesting JSON with mixed case column names, do not have any ETL in place to lower case those column names, and would like to make queries that include the data you created using 0.6.x and 0.7.x.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>format</td>
<td>String</td>
<td>This should say <code>jsonLowercase</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>timestampSpec</td>
<td>JSON Object</td>
<td>Specifies the column and format of the timestamp.</td>
<td>yes</td>
</tr>
<tr>
<td>dimensionsSpec</td>
<td>JSON Object</td>
<td>Specifies the dimensions of the data.</td>
<td>yes</td>
</tr>
</tbody>
</table>
<h3 id="csv-parsespec"><a name="csv-parsespec" class="anchor-navigation-ex-anchor" href="#csv-parsespec"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.3. CSV ParseSpec</h3>
<p>Use this with the String Parser to load CSV. Strings are parsed using the com.opencsv library.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>format</td>
<td>String</td>
<td>This should say <code>csv</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>timestampSpec</td>
<td>JSON Object</td>
<td>Specifies the column and format of the timestamp.</td>
<td>yes</td>
</tr>
<tr>
<td>dimensionsSpec</td>
<td>JSON Object</td>
<td>Specifies the dimensions of the data.</td>
<td>yes</td>
</tr>
<tr>
<td>listDelimiter</td>
<td>String</td>
<td>A custom delimiter for multi-value dimensions.</td>
<td>no (default = ctrl+A)</td>
</tr>
<tr>
<td>columns</td>
<td>JSON array</td>
<td>Specifies the columns of the data.</td>
<td>yes</td>
</tr>
</tbody>
</table>
<p>Sample spec:</p>
<pre><code class="lang-json"><span class="hljs-string">&quot;parseSpec&quot;</span>: {
  <span class="hljs-string">&quot;format&quot;</span> : <span class="hljs-string">&quot;csv&quot;</span>,
  <span class="hljs-string">&quot;timestampSpec&quot;</span> : {
    <span class="hljs-string">&quot;column&quot;</span> : <span class="hljs-string">&quot;timestamp&quot;</span>
  },
  <span class="hljs-string">&quot;columns&quot;</span> : [<span class="hljs-string">&quot;timestamp&quot;</span>,<span class="hljs-string">&quot;page&quot;</span>,<span class="hljs-string">&quot;language&quot;</span>,<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-string">&quot;unpatrolled&quot;</span>,<span class="hljs-string">&quot;newPage&quot;</span>,<span class="hljs-string">&quot;robot&quot;</span>,<span class="hljs-string">&quot;anonymous&quot;</span>,<span class="hljs-string">&quot;namespace&quot;</span>,<span class="hljs-string">&quot;continent&quot;</span>,<span class="hljs-string">&quot;country&quot;</span>,<span class="hljs-string">&quot;region&quot;</span>,<span class="hljs-string">&quot;city&quot;</span>,<span class="hljs-string">&quot;added&quot;</span>,<span class="hljs-string">&quot;deleted&quot;</span>,<span class="hljs-string">&quot;delta&quot;</span>],
  <span class="hljs-string">&quot;dimensionsSpec&quot;</span> : {
    <span class="hljs-string">&quot;dimensions&quot;</span> : [<span class="hljs-string">&quot;page&quot;</span>,<span class="hljs-string">&quot;language&quot;</span>,<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-string">&quot;unpatrolled&quot;</span>,<span class="hljs-string">&quot;newPage&quot;</span>,<span class="hljs-string">&quot;robot&quot;</span>,<span class="hljs-string">&quot;anonymous&quot;</span>,<span class="hljs-string">&quot;namespace&quot;</span>,<span class="hljs-string">&quot;continent&quot;</span>,<span class="hljs-string">&quot;country&quot;</span>,<span class="hljs-string">&quot;region&quot;</span>,<span class="hljs-string">&quot;city&quot;</span>]
  }
}
</code></pre>
<h4 id="csv-index-tasks"><a name="csv-index-tasks" class="anchor-navigation-ex-anchor" href="#csv-index-tasks"><i class="fa fa-link" aria-hidden="true"></i></a>CSV Index Tasks</h4>
<p>If your input files contain a header, the <code>columns</code> field is optional and you don&apos;t need to set.
Instead, you can set the <code>hasHeaderRow</code> field to true, which makes Druid automatically extract the column information from the header.
Otherwise, you must set the <code>columns</code> field and ensure that field must match the columns of your input data in the same order.</p>
<p>Also, you can skip some header rows by setting <code>skipHeaderRows</code> in your parseSpec. If both <code>skipHeaderRows</code> and <code>hasHeaderRow</code> options are set,
<code>skipHeaderRows</code> is first applied. For example, if you set <code>skipHeaderRows</code> to 2 and <code>hasHeaderRow</code> to true, Druid will
skip the first two lines and then extract column information from the third line.</p>
<p>Note that <code>hasHeaderRow</code> and <code>skipHeaderRows</code> are effective only for non-Hadoop batch index tasks. Other types of index
tasks will fail with an exception.</p>
<h4 id="other-csv-ingestion-tasks"><a name="other-csv-ingestion-tasks" class="anchor-navigation-ex-anchor" href="#other-csv-ingestion-tasks"><i class="fa fa-link" aria-hidden="true"></i></a>Other CSV Ingestion Tasks</h4>
<p>The <code>columns</code> field must be included and and ensure that the order of the fields matches the columns of your input data in the same order.</p>
<h3 id="tsv--delimited-parsespec"><a name="tsv--delimited-parsespec" class="anchor-navigation-ex-anchor" href="#tsv--delimited-parsespec"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.4. TSV / Delimited ParseSpec</h3>
<p>Use this with the String Parser to load any delimited text that does not require special escaping. By default,
the delimiter is a tab, so this will load TSV.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>format</td>
<td>String</td>
<td>This should say <code>tsv</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>timestampSpec</td>
<td>JSON Object</td>
<td>Specifies the column and format of the timestamp.</td>
<td>yes</td>
</tr>
<tr>
<td>dimensionsSpec</td>
<td>JSON Object</td>
<td>Specifies the dimensions of the data.</td>
<td>yes</td>
</tr>
<tr>
<td>delimiter</td>
<td>String</td>
<td>A custom delimiter for data values.</td>
<td>no (default = \t)</td>
</tr>
<tr>
<td>listDelimiter</td>
<td>String</td>
<td>A custom delimiter for multi-value dimensions.</td>
<td>no (default = ctrl+A)</td>
</tr>
<tr>
<td>columns</td>
<td>JSON String array</td>
<td>Specifies the columns of the data.</td>
<td>yes</td>
</tr>
</tbody>
</table>
<p>Sample spec:</p>
<pre><code class="lang-json"><span class="hljs-string">&quot;parseSpec&quot;</span>: {
  <span class="hljs-string">&quot;format&quot;</span> : <span class="hljs-string">&quot;tsv&quot;</span>,
  <span class="hljs-string">&quot;timestampSpec&quot;</span> : {
    <span class="hljs-string">&quot;column&quot;</span> : <span class="hljs-string">&quot;timestamp&quot;</span>
  },
  <span class="hljs-string">&quot;columns&quot;</span> : [<span class="hljs-string">&quot;timestamp&quot;</span>,<span class="hljs-string">&quot;page&quot;</span>,<span class="hljs-string">&quot;language&quot;</span>,<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-string">&quot;unpatrolled&quot;</span>,<span class="hljs-string">&quot;newPage&quot;</span>,<span class="hljs-string">&quot;robot&quot;</span>,<span class="hljs-string">&quot;anonymous&quot;</span>,<span class="hljs-string">&quot;namespace&quot;</span>,<span class="hljs-string">&quot;continent&quot;</span>,<span class="hljs-string">&quot;country&quot;</span>,<span class="hljs-string">&quot;region&quot;</span>,<span class="hljs-string">&quot;city&quot;</span>,<span class="hljs-string">&quot;added&quot;</span>,<span class="hljs-string">&quot;deleted&quot;</span>,<span class="hljs-string">&quot;delta&quot;</span>],
  <span class="hljs-string">&quot;delimiter&quot;</span>:<span class="hljs-string">&quot;|&quot;</span>,
  <span class="hljs-string">&quot;dimensionsSpec&quot;</span> : {
    <span class="hljs-string">&quot;dimensions&quot;</span> : [<span class="hljs-string">&quot;page&quot;</span>,<span class="hljs-string">&quot;language&quot;</span>,<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-string">&quot;unpatrolled&quot;</span>,<span class="hljs-string">&quot;newPage&quot;</span>,<span class="hljs-string">&quot;robot&quot;</span>,<span class="hljs-string">&quot;anonymous&quot;</span>,<span class="hljs-string">&quot;namespace&quot;</span>,<span class="hljs-string">&quot;continent&quot;</span>,<span class="hljs-string">&quot;country&quot;</span>,<span class="hljs-string">&quot;region&quot;</span>,<span class="hljs-string">&quot;city&quot;</span>]
  }
}
</code></pre>
<p>Be sure to change the <code>delimiter</code> to the appropriate delimiter for your data. Like CSV, you must specify the columns and which subset of the columns you want indexed.</p>
<h4 id="tsv-delimited-index-tasks"><a name="tsv-delimited-index-tasks" class="anchor-navigation-ex-anchor" href="#tsv-delimited-index-tasks"><i class="fa fa-link" aria-hidden="true"></i></a>TSV (Delimited) Index Tasks</h4>
<p>If your input files contain a header, the <code>columns</code> field is optional and doesn&apos;t need to be set.
Instead, you can set the <code>hasHeaderRow</code> field to true, which makes Druid automatically extract the column information from the header.
Otherwise, you must set the <code>columns</code> field and ensure that field must match the columns of your input data in the same order.</p>
<p>Also, you can skip some header rows by setting <code>skipHeaderRows</code> in your parseSpec. If both <code>skipHeaderRows</code> and <code>hasHeaderRow</code> options are set,
<code>skipHeaderRows</code> is first applied. For example, if you set <code>skipHeaderRows</code> to 2 and <code>hasHeaderRow</code> to true, Druid will
skip the first two lines and then extract column information from the third line.</p>
<p>Note that <code>hasHeaderRow</code> and <code>skipHeaderRows</code> are effective only for non-Hadoop batch index tasks. Other types of index
tasks will fail with an exception.</p>
<h4 id="other-tsv-delimited-ingestion-tasks"><a name="other-tsv-delimited-ingestion-tasks" class="anchor-navigation-ex-anchor" href="#other-tsv-delimited-ingestion-tasks"><i class="fa fa-link" aria-hidden="true"></i></a>Other TSV (Delimited) Ingestion Tasks</h4>
<p>The <code>columns</code> field must be included and and ensure that the order of the fields matches the columns of your input data in the same order.</p>
<h3 id="multi-value-dimensions"><a name="multi-value-dimensions" class="anchor-navigation-ex-anchor" href="#multi-value-dimensions"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.5. Multi-value dimensions</h3>
<p>Dimensions can have multiple values for TSV and CSV data. To specify the delimiter for a multi-value dimension, set the <code>listDelimiter</code> in the <code>parseSpec</code>.</p>
<p>JSON data can contain multi-value dimensions as well. The multiple values for a dimension must be formatted as a JSON array in the ingested data. No additional <code>parseSpec</code> configuration is needed.</p>
<h3 id="regex-parsespec"><a name="regex-parsespec" class="anchor-navigation-ex-anchor" href="#regex-parsespec"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.6. Regex ParseSpec</h3>
<pre><code class="lang-json"><span class="hljs-string">&quot;parseSpec&quot;</span>:{
  <span class="hljs-string">&quot;format&quot;</span> : <span class="hljs-string">&quot;regex&quot;</span>,
  <span class="hljs-string">&quot;timestampSpec&quot;</span> : {
    <span class="hljs-string">&quot;column&quot;</span> : <span class="hljs-string">&quot;timestamp&quot;</span>
  },
  <span class="hljs-string">&quot;dimensionsSpec&quot;</span> : {
    <span class="hljs-string">&quot;dimensions&quot;</span> : [&lt;your_list_of_dimensions&gt;]
  },
  &quot;columns&quot; : [&lt;your_columns_here&gt;],
  &quot;pattern&quot; : &lt;regex pattern for partitioning data&gt;
}
</code></pre>
<p>The <code>columns</code> field must match the columns of your regex matching groups in the same order. If columns are not provided, default
columns names (&quot;column_1&quot;, &quot;column2&quot;, ... &quot;column_n&quot;) will be assigned. Ensure that your column names include all your dimensions.</p>
<h3 id="javascript-parsespec"><a name="javascript-parsespec" class="anchor-navigation-ex-anchor" href="#javascript-parsespec"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.7. JavaScript ParseSpec</h3>
<pre><code class="lang-json"><span class="hljs-string">&quot;parseSpec&quot;</span>:{
  <span class="hljs-string">&quot;format&quot;</span> : <span class="hljs-string">&quot;javascript&quot;</span>,
  <span class="hljs-string">&quot;timestampSpec&quot;</span> : {
    <span class="hljs-string">&quot;column&quot;</span> : <span class="hljs-string">&quot;timestamp&quot;</span>
  },
  <span class="hljs-string">&quot;dimensionsSpec&quot;</span> : {
    <span class="hljs-string">&quot;dimensions&quot;</span> : [<span class="hljs-string">&quot;page&quot;</span>,<span class="hljs-string">&quot;language&quot;</span>,<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-string">&quot;unpatrolled&quot;</span>,<span class="hljs-string">&quot;newPage&quot;</span>,<span class="hljs-string">&quot;robot&quot;</span>,<span class="hljs-string">&quot;anonymous&quot;</span>,<span class="hljs-string">&quot;namespace&quot;</span>,<span class="hljs-string">&quot;continent&quot;</span>,<span class="hljs-string">&quot;country&quot;</span>,<span class="hljs-string">&quot;region&quot;</span>,<span class="hljs-string">&quot;city&quot;</span>]
  },
  <span class="hljs-string">&quot;function&quot;</span> : <span class="hljs-string">&quot;function(str) { var parts = str.split(\&quot;-\&quot;); return { one: parts[0], two: parts[1] } }&quot;</span>
}
</code></pre>
<p>Note with the JavaScript parser that data must be fully parsed and returned as a <code>{key:value}</code> format in the JS logic.
This means any flattening or parsing multi-dimensional values must be done here.</p>
<blockquote>
<p>JavaScript-based functionality is disabled by default. Please refer to the Druid <a href="../development/javascript.html">JavaScript programming guide</a> for guidelines about using Druid&apos;s JavaScript functionality, including instructions on how to enable it.</p>
</blockquote>
<h3 id="timeanddims-parsespec"><a name="timeanddims-parsespec" class="anchor-navigation-ex-anchor" href="#timeanddims-parsespec"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.8. TimeAndDims ParseSpec</h3>
<p>Use this with non-String Parsers to provide them with timestamp and dimensions information. Non-String Parsers
handle all formatting decisions on their own, without using the ParseSpec.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>format</td>
<td>String</td>
<td>This should say <code>timeAndDims</code>.</td>
<td>yes</td>
</tr>
<tr>
<td>timestampSpec</td>
<td>JSON Object</td>
<td>Specifies the column and format of the timestamp.</td>
<td>yes</td>
</tr>
<tr>
<td>dimensionsSpec</td>
<td>JSON Object</td>
<td>Specifies the dimensions of the data.</td>
<td>yes</td>
</tr>
</tbody>
</table>
<h3 id="orc-parsespec"><a name="orc-parsespec" class="anchor-navigation-ex-anchor" href="#orc-parsespec"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.9. Orc ParseSpec</h3>
<p>Use this with the Hadoop ORC Parser to load ORC files.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>format</td>
<td>String</td>
<td>This should say <code>orc</code>.</td>
<td>no</td>
</tr>
<tr>
<td>timestampSpec</td>
<td>JSON Object</td>
<td>Specifies the column and format of the timestamp.</td>
<td>yes</td>
</tr>
<tr>
<td>dimensionsSpec</td>
<td>JSON Object</td>
<td>Specifies the dimensions of the data.</td>
<td>yes</td>
</tr>
<tr>
<td>flattenSpec</td>
<td>JSON Object</td>
<td>Specifies flattening configuration for nested JSON data. See <a href="#flattenspec"><code>flattenSpec</code></a> for more info.</td>
<td>no</td>
</tr>
</tbody>
</table>
<h3 id="parquet-parsespec"><a name="parquet-parsespec" class="anchor-navigation-ex-anchor" href="#parquet-parsespec"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.10. Parquet ParseSpec</h3>
<p>Use this with the Hadoop Parquet Parser to load Parquet files.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>format</td>
<td>String</td>
<td>This should say <code>parquet</code>.</td>
<td>no</td>
</tr>
<tr>
<td>timestampSpec</td>
<td>JSON Object</td>
<td>Specifies the column and format of the timestamp.</td>
<td>yes</td>
</tr>
<tr>
<td>dimensionsSpec</td>
<td>JSON Object</td>
<td>Specifies the dimensions of the data.</td>
<td>yes</td>
</tr>
<tr>
<td>flattenSpec</td>
<td>JSON Object</td>
<td>Specifies flattening configuration for nested JSON data. See <a href="#flattenspec"><code>flattenSpec</code></a> for more info.</td>
<td>no</td>
</tr>
</tbody>
</table>
<footer class="page-footer"><span class="copyright">Copyright <a target="_blank" href="https://druid.org.cn">druid.org.cn</a> 2021 .&#x672C;&#x6587;&#x7FFB;&#x8BD1;&#x81EA;Apache Druid&#xFF0C;<a href="https://github.com/apache/druid/tree/master/docs/ingestion/data-formats.md" target="_blank">&#x9605;&#x8BFB;&#x539F;&#x6587;</a> </span><span class="footer-modification">&#x66F4;&#x65B0;&#x4E8E;&#xFF1A;
2021-04-23 21:43:10
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: 概览">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="schema-design.html" class="navigation navigation-next " aria-label="Next page: Schema定义">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"id":"data-formats","title":"数据格式","level":"1.5.2","depth":2,"next":{"title":"Schema定义","level":"1.5.3","depth":2,"path":"ingestion/schema-design.md","ref":"ingestion/schema-design.md","articles":[]},"previous":{"title":"概览","level":"1.5.1","depth":2,"path":"ingestion/index.md","ref":"ingestion/index.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["-search","highlight","livereload","search-pro","code","tbfed-pagefooter","anchor-navigation-ex","auto-scroll-table","hide-element","github"],"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright <a target=\"_blank\" href=\"https://druid.org.cn\">druid.org.cn</a> 2021 .本文翻译自Apache Druid，<a href=\"https://github.com/apache/druid/tree/master/docs/{{file.path}}\">阅读原文</a>","modify_label":"更新于：","modify_format":"YYYY-MM-DD HH:mm:ss"},"github":{"url":"https://github.com/apache/druid"},"livereload":{},"search-pro":{},"auto-scroll-table":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code":{"copyButtons":true},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"ingestion/data-formats.md","mtime":"2021-04-23T13:43:10.290Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-04-24T03:56:48.676Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

